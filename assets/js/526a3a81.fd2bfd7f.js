"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[8550],{3905:function(a,e,m){m.r(e),m.d(e,{MDXContext:function(){return l},MDXProvider:function(){return x},mdx:function(){return h},useMDXComponents:function(){return d},withMDXComponents:function(){return i}});var s=m(67294);function n(a,e,m){return e in a?Object.defineProperty(a,e,{value:m,enumerable:!0,configurable:!0,writable:!0}):a[e]=m,a}function t(){return t=Object.assign||function(a){for(var e=1;e<arguments.length;e++){var m=arguments[e];for(var s in m)Object.prototype.hasOwnProperty.call(m,s)&&(a[s]=m[s])}return a},t.apply(this,arguments)}function p(a,e){var m=Object.keys(a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(a);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),m.push.apply(m,s)}return m}function r(a){for(var e=1;e<arguments.length;e++){var m=null!=arguments[e]?arguments[e]:{};e%2?p(Object(m),!0).forEach((function(e){n(a,e,m[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(m)):p(Object(m)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(m,e))}))}return a}function N(a,e){if(null==a)return{};var m,s,n=function(a,e){if(null==a)return{};var m,s,n={},t=Object.keys(a);for(s=0;s<t.length;s++)m=t[s],e.indexOf(m)>=0||(n[m]=a[m]);return n}(a,e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(a);for(s=0;s<t.length;s++)m=t[s],e.indexOf(m)>=0||Object.prototype.propertyIsEnumerable.call(a,m)&&(n[m]=a[m])}return n}var l=s.createContext({}),i=function(a){return function(e){var m=d(e.components);return s.createElement(a,t({},e,{components:m}))}},d=function(a){var e=s.useContext(l),m=e;return a&&(m="function"==typeof a?a(e):r(r({},e),a)),m},x=function(a){var e=d(a.components);return s.createElement(l.Provider,{value:e},a.children)},c={inlineCode:"code",wrapper:function(a){var e=a.children;return s.createElement(s.Fragment,{},e)}},o=s.forwardRef((function(a,e){var m=a.components,n=a.mdxType,t=a.originalType,p=a.parentName,l=N(a,["components","mdxType","originalType","parentName"]),i=d(m),x=n,o=i["".concat(p,".").concat(x)]||i[x]||c[x]||t;return m?s.createElement(o,r(r({ref:e},l),{},{components:m})):s.createElement(o,r({ref:e},l))}));function h(a,e){var m=arguments,n=e&&e.mdxType;if("string"==typeof a||n){var t=m.length,p=new Array(t);p[0]=o;var r={};for(var N in e)hasOwnProperty.call(e,N)&&(r[N]=e[N]);r.originalType=a,r.mdxType="string"==typeof a?a:n,p[1]=r;for(var l=2;l<t;l++)p[l]=m[l];return s.createElement.apply(null,p)}return s.createElement.apply(null,m)}o.displayName="MDXCreateElement"},21118:function(a,e,m){m.r(e),m.d(e,{frontMatter:function(){return r},contentTitle:function(){return N},metadata:function(){return l},toc:function(){return i},default:function(){return x}});var s=m(87462),n=m(63366),t=(m(67294),m(3905)),p=["components"],r={},N="Newtonian Monte Carlo",l={unversionedId:"framework_topics/inference/newtonian_monte_carlo",id:"framework_topics/inference/newtonian_monte_carlo",isDocsHomePage:!1,title:"Newtonian Monte Carlo",description:"Newtonian Monte Carlo (NMC, Arora et al., 2020) is a second-order gradient-based Markov chain Monte Carlo (MCMC) algorithm that uses the first- and second-order gradients to propose a new value for a random variable.",source:"@site/../docs/framework_topics/inference/newtonian_monte_carlo.md",sourceDirName:"framework_topics/inference",slug:"/framework_topics/inference/newtonian_monte_carlo",permalink:"/docs/framework_topics/inference/newtonian_monte_carlo",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/../docs/framework_topics/inference/newtonian_monte_carlo.md",tags:[],version:"current",frontMatter:{}},i=[{value:"Real-space NMC proposer",id:"real-space-nmc-proposer",children:[],level:2},{value:"Half-space NMC proposer",id:"half-space-nmc-proposer",children:[],level:2},{value:"Simplex proposer",id:"simplex-proposer",children:[],level:2},{value:"NMC algorithm",id:"nmc-algorithm",children:[],level:2},{value:"Using NMC",id:"using-nmc",children:[],level:2}],d={toc:i};function x(a){var e=a.components,m=(0,n.Z)(a,p);return(0,t.mdx)("wrapper",(0,s.Z)({},d,m,{components:e,mdxType:"MDXLayout"}),(0,t.mdx)("h1",{id:"newtonian-monte-carlo"},"Newtonian Monte Carlo"),(0,t.mdx)("p",null,"Newtonian Monte Carlo (NMC, Arora et al., 2020) is a second-order gradient-based Markov chain Monte Carlo (MCMC) algorithm that uses the first- and second-order gradients to propose a new value for a random variable."),(0,t.mdx)("p",null,"To understand the idea behind NMC, we revisit two other common MCMC algorithms, ",(0,t.mdx)("a",{parentName:"p",href:"/docs/framework_topics/inference/random_walk"},"Random Walk")," and Metropolis-adjusted Langevin algorithm (MALA). In Random Walk, we propose the next parameter value ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("mo",{parentName:"mrow"},"\u2208"),(0,t.mdx)("msup",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msup",mathvariant:"double-struck"},"R"),(0,t.mdx)("mi",{parentName:"msup"},"k"))),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\theta\\in\\R^k")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.73354em",verticalAlign:"-0.0391em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,t.mdx)("span",{parentName:"span",className:"mrel"},"\u2208"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.849108em",verticalAlign:"0em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord mathbb"},"R")),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.849108em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k"))))))))))))," for our model using a simple Normal distribution centered at the current value: ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"q"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"."),(0,t.mdx)("mo",{parentName:"mrow"},"\u2223"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow"},"="),(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"script"},"N"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("mo",{parentName:"mrow",separator:"true"},","),(0,t.mdx)("msup",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msup"},"\u03f5"),(0,t.mdx)("mn",{parentName:"msup"},"2")),(0,t.mdx)("msub",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msub"},"I"),(0,t.mdx)("mi",{parentName:"msub"},"k")),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"q(. \\mid \\theta) = \\mathcal{N}(\\theta, \\epsilon^2I_k)")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"q"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord"},"."),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,t.mdx)("span",{parentName:"span",className:"mrel"},"\u2223"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,t.mdx)("span",{parentName:"span",className:"mrel"},"="),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1.064108em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord mathcal",style:{marginRight:"0.14736em"}},"N")),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mpunct"},","),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"\u03f5"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.8141079999999999em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},"2")))))))),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"I"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.33610799999999996em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.5500000000000003em",marginLeft:"-0.07847em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k")))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.mdx)("span",{parentName:"span"})))))),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"))))),". This Normal distribution has covariance ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("msup",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msup"},"\u03f5"),(0,t.mdx)("mn",{parentName:"msup"},"2")),(0,t.mdx)("msub",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msub"},"I"),(0,t.mdx)("mi",{parentName:"msub"},"k"))),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\epsilon^2I_k")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.964108em",verticalAlign:"-0.15em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"\u03f5"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.8141079999999999em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},"2")))))))),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"I"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.33610799999999996em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.5500000000000003em",marginLeft:"-0.07847em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k")))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.mdx)("span",{parentName:"span"}))))))))))," where ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"\u03f5")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\epsilon")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.43056em",verticalAlign:"0em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"\u03f5")))))," is the user-specified step size and ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("msub",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msub"},"I"),(0,t.mdx)("mi",{parentName:"msub"},"k"))),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"I_k")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.83333em",verticalAlign:"-0.15em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"I"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.33610799999999996em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.5500000000000003em",marginLeft:"-0.07847em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k")))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.mdx)("span",{parentName:"span"}))))))))))," \u200bis a ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"k"),(0,t.mdx)("mo",{parentName:"mrow"},"\xd7"),(0,t.mdx)("mi",{parentName:"mrow"},"k")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"k \\times k")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.77777em",verticalAlign:"-0.08333em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03148em"}},"k"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}}),(0,t.mdx)("span",{parentName:"span",className:"mbin"},"\xd7"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.69444em",verticalAlign:"0em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03148em"}},"k")))))," identity matrix (Metropolis et al., 1953). In cases where the target density, ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"\u03c0"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\pi(\\theta)")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"\u03c0"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"))))),", is differentiable, we can use the proposal distribution proposed by MALA which is ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"q"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"."),(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2223"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow"},"="),(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"script"},"N"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("mo",{parentName:"mrow"},"+"),(0,t.mdx)("mfrac",{parentName:"mrow"},(0,t.mdx)("msup",{parentName:"mfrac"},(0,t.mdx)("mi",{parentName:"msup"},"\u03f5"),(0,t.mdx)("mn",{parentName:"msup"},"2")),(0,t.mdx)("mn",{parentName:"mfrac"},"2")),(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2207"),(0,t.mdx)("mi",{parentName:"mrow"},"log"),(0,t.mdx)("mo",{parentName:"mrow"},"\u2061"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03c0"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow",separator:"true"},","),(0,t.mdx)("msup",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msup"},"\u03f5"),(0,t.mdx)("mn",{parentName:"msup"},"2")),(0,t.mdx)("msub",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msub"},"I"),(0,t.mdx)("mi",{parentName:"msub"},"k")),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"q(.|\\theta)=\\mathcal{N}(\\theta+\\frac{\\epsilon^2}{2}\\nabla \\log\\pi(\\theta), \\epsilon^2I_k)")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"q"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord"},"."),(0,t.mdx)("span",{parentName:"span",className:"mord"},"\u2223"),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,t.mdx)("span",{parentName:"span",className:"mrel"},"="),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord mathcal",style:{marginRight:"0.14736em"}},"N")),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}}),(0,t.mdx)("span",{parentName:"span",className:"mbin"},"+"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1.36292em",verticalAlign:"-0.345em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mopen nulldelimiter"}),(0,t.mdx)("span",{parentName:"span",className:"mfrac"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"1.01792em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.6550000000000002em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,t.mdx)("span",{parentName:"span",style:{top:"-3.23em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,t.mdx)("span",{parentName:"span",className:"frac-line",style:{borderBottomWidth:"0.04em"}})),(0,t.mdx)("span",{parentName:"span",style:{top:"-3.394em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"\u03f5"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.8913142857142857em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.931em",marginRight:"0.07142857142857144em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.5em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size3 size1 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},"2")))))))))))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.345em"}},(0,t.mdx)("span",{parentName:"span"}))))),(0,t.mdx)("span",{parentName:"span",className:"mclose nulldelimiter"})),(0,t.mdx)("span",{parentName:"span",className:"mord"},"\u2207"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mop"},"lo",(0,t.mdx)("span",{parentName:"span",style:{marginRight:"0.01389em"}},"g")),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"\u03c0"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mpunct"},","),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"\u03f5"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.8141079999999999em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},"2")))))))),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"I"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.33610799999999996em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.5500000000000003em",marginLeft:"-0.07847em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k")))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.mdx)("span",{parentName:"span"})))))),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")")))))," (Robert & Tweedie, 1996). In MALA, we use a Normal distribution whose mean is ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mfrac",{parentName:"mrow"},(0,t.mdx)("msup",{parentName:"mfrac"},(0,t.mdx)("mi",{parentName:"msup"},"\u03f5"),(0,t.mdx)("mn",{parentName:"msup"},"2")),(0,t.mdx)("mn",{parentName:"mfrac"},"2"))),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\frac{\\epsilon^2}{2}")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1.36292em",verticalAlign:"-0.345em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mopen nulldelimiter"}),(0,t.mdx)("span",{parentName:"span",className:"mfrac"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"1.01792em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.6550000000000002em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,t.mdx)("span",{parentName:"span",style:{top:"-3.23em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,t.mdx)("span",{parentName:"span",className:"frac-line",style:{borderBottomWidth:"0.04em"}})),(0,t.mdx)("span",{parentName:"span",style:{top:"-3.394em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"\u03f5"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.8913142857142857em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.931em",marginRight:"0.07142857142857144em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.5em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size3 size1 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},"2")))))))))))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.345em"}},(0,t.mdx)("span",{parentName:"span"}))))),(0,t.mdx)("span",{parentName:"span",className:"mclose nulldelimiter"})))))),"\u200b away from the current value, ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\theta")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.69444em",verticalAlign:"0em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"))))),", in the direction of the first-order gradient of the target density, ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"\u03c0"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\pi(\\theta)")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"\u03c0"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"))))),". In both Random Walk and MALA, we have the problem of finding the correct step size. A large step size may lead to an ineffective exploration of the space and low acceptance rate. A small step size can lead to a high acceptance rate but slow exploration of the space."),(0,t.mdx)("p",null,"In NMC, we follow the same intuition and try to overcome the problem of choosing the step size by using the second-order gradient information. NMC offers different proposers based on the support of the random variable ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\theta")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.69444em",verticalAlign:"0em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"))))),", Real-Space proposer, Half-Space proposer and Simplex space proposer. One can also choose to transform the random variable ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\theta")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.69444em",verticalAlign:"0em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8")))))," from Half-Space or simplex into Real-Space and use the Real-Space proposer algorithm."),(0,t.mdx)("h2",{id:"real-space-nmc-proposer"},"Real-space NMC proposer"),(0,t.mdx)("p",null,"NMC uses a Multivariate Normal distribution to propose values in unconstrained space. Conceptually, NMC theorizes that the posterior is shaped like a Normal distribution. It uses first- and second-order gradient information from the current sample in order to build a proposal distribution whose shape matches that of this theoretical Normal distribution."),(0,t.mdx)("p",null,"Mathematically, the proposal distribution ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"q")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"q")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.625em",verticalAlign:"-0.19444em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"q")))))," used as a function of the current sample location ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\theta")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.69444em",verticalAlign:"0em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8")))))," is: ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"q"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"."),(0,t.mdx)("mo",{parentName:"mrow"},"\u2223"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow"},"="),(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"script"},"N"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("mo",{parentName:"mrow"},"\u2212"),(0,t.mdx)("msup",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msup",mathvariant:"normal"},"\u2207"),(0,t.mdx)("mn",{parentName:"msup"},"2")),(0,t.mdx)("mi",{parentName:"mrow"},"log"),(0,t.mdx)("mo",{parentName:"mrow"},"\u2061"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03c0"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("msup",{parentName:"mrow"},(0,t.mdx)("mo",{parentName:"msup",stretchy:"false"},")"),(0,t.mdx)("mrow",{parentName:"msup"},(0,t.mdx)("mo",{parentName:"mrow"},"\u2212"),(0,t.mdx)("mn",{parentName:"mrow"},"1"))),(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2207"),(0,t.mdx)("mi",{parentName:"mrow"},"log"),(0,t.mdx)("mo",{parentName:"mrow"},"\u2061"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03c0"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow",separator:"true"},","),(0,t.mdx)("mo",{parentName:"mrow"},"\u2212"),(0,t.mdx)("msup",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msup",mathvariant:"normal"},"\u2207"),(0,t.mdx)("mn",{parentName:"msup"},"2")),(0,t.mdx)("mi",{parentName:"mrow"},"log"),(0,t.mdx)("mo",{parentName:"mrow"},"\u2061"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03c0"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("msup",{parentName:"mrow"},(0,t.mdx)("mo",{parentName:"msup",stretchy:"false"},")"),(0,t.mdx)("mrow",{parentName:"msup"},(0,t.mdx)("mo",{parentName:"mrow"},"\u2212"),(0,t.mdx)("mn",{parentName:"mrow"},"1"))),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"q(. \\mid \\theta)=\\mathcal{N}(\\theta-\\nabla^2 \\log\\pi(\\theta)^{-1}\\nabla \\log\\pi(\\theta), -\\nabla ^2\\log\\pi(\\theta)^{-1})")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"q"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord"},"."),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,t.mdx)("span",{parentName:"span",className:"mrel"},"\u2223"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,t.mdx)("span",{parentName:"span",className:"mrel"},"="),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord mathcal",style:{marginRight:"0.14736em"}},"N")),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}}),(0,t.mdx)("span",{parentName:"span",className:"mbin"},"\u2212"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1.064108em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord"},"\u2207"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.8141079999999999em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},"2")))))))),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mop"},"lo",(0,t.mdx)("span",{parentName:"span",style:{marginRight:"0.01389em"}},"g")),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"\u03c0"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.8141079999999999em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},"\u2212"),(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},"1"))))))))),(0,t.mdx)("span",{parentName:"span",className:"mord"},"\u2207"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mop"},"lo",(0,t.mdx)("span",{parentName:"span",style:{marginRight:"0.01389em"}},"g")),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"\u03c0"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mpunct"},","),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},"\u2212"),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord"},"\u2207"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.8141079999999999em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},"2")))))))),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mop"},"lo",(0,t.mdx)("span",{parentName:"span",style:{marginRight:"0.01389em"}},"g")),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"\u03c0"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.8141079999999999em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},"\u2212"),(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},"1"))))))))),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"))))),"."),(0,t.mdx)("p",null,'This proposal distribution works well the closer that the posterior is to a Normal distribution. However, in cases when the posterior is quite dissimilar to a Normal distribution, this proposer may overfit to its Normal assumption. To alleviate this, we introduce a "learning rate" ',(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"\u03b3")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\gamma")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.625em",verticalAlign:"-0.19444em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05556em"}},"\u03b3"))))),", whose purpose is to reduce the strength of that Normal assumption when choosing a mean for the proposal distribution. The proposal distribution with the learning rate is: ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"q"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"."),(0,t.mdx)("mo",{parentName:"mrow"},"\u2223"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow"},"="),(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"script"},"N"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("mo",{parentName:"mrow"},"\u2212"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b3"),(0,t.mdx)("msup",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msup",mathvariant:"normal"},"\u2207"),(0,t.mdx)("mn",{parentName:"msup"},"2")),(0,t.mdx)("mi",{parentName:"mrow"},"log"),(0,t.mdx)("mo",{parentName:"mrow"},"\u2061"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03c0"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("msup",{parentName:"mrow"},(0,t.mdx)("mo",{parentName:"msup",stretchy:"false"},")"),(0,t.mdx)("mrow",{parentName:"msup"},(0,t.mdx)("mo",{parentName:"mrow"},"\u2212"),(0,t.mdx)("mn",{parentName:"mrow"},"1"))),(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2207"),(0,t.mdx)("mi",{parentName:"mrow"},"log"),(0,t.mdx)("mo",{parentName:"mrow"},"\u2061"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03c0"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow",separator:"true"},","),(0,t.mdx)("mo",{parentName:"mrow"},"\u2212"),(0,t.mdx)("msup",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msup",mathvariant:"normal"},"\u2207"),(0,t.mdx)("mn",{parentName:"msup"},"2")),(0,t.mdx)("mi",{parentName:"mrow"},"log"),(0,t.mdx)("mo",{parentName:"mrow"},"\u2061"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03c0"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("msup",{parentName:"mrow"},(0,t.mdx)("mo",{parentName:"msup",stretchy:"false"},")"),(0,t.mdx)("mrow",{parentName:"msup"},(0,t.mdx)("mo",{parentName:"mrow"},"\u2212"),(0,t.mdx)("mn",{parentName:"mrow"},"1"))),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"q(. \\mid \\theta)=\\mathcal{N}(\\theta-\\gamma\\nabla^2 \\log\\pi(\\theta)^{-1}\\nabla \\log\\pi(\\theta), -\\nabla ^2\\log\\pi(\\theta)^{-1})")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"q"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord"},"."),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,t.mdx)("span",{parentName:"span",className:"mrel"},"\u2223"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,t.mdx)("span",{parentName:"span",className:"mrel"},"="),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord mathcal",style:{marginRight:"0.14736em"}},"N")),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}}),(0,t.mdx)("span",{parentName:"span",className:"mbin"},"\u2212"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1.064108em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05556em"}},"\u03b3"),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord"},"\u2207"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.8141079999999999em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},"2")))))))),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mop"},"lo",(0,t.mdx)("span",{parentName:"span",style:{marginRight:"0.01389em"}},"g")),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"\u03c0"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.8141079999999999em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},"\u2212"),(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},"1"))))))))),(0,t.mdx)("span",{parentName:"span",className:"mord"},"\u2207"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mop"},"lo",(0,t.mdx)("span",{parentName:"span",style:{marginRight:"0.01389em"}},"g")),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"\u03c0"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mpunct"},","),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},"\u2212"),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord"},"\u2207"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.8141079999999999em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},"2")))))))),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mop"},"lo",(0,t.mdx)("span",{parentName:"span",style:{marginRight:"0.01389em"}},"g")),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"\u03c0"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.8141079999999999em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},"\u2212"),(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},"1"))))))))),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"))))),". ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"\u03b3"),(0,t.mdx)("mo",{parentName:"mrow"},"\u2208"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"["),(0,t.mdx)("mn",{parentName:"mrow"},"0"),(0,t.mdx)("mo",{parentName:"mrow",separator:"true"},","),(0,t.mdx)("mn",{parentName:"mrow"},"1"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"]")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\gamma\\in[0, 1]")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.7335400000000001em",verticalAlign:"-0.19444em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05556em"}},"\u03b3"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,t.mdx)("span",{parentName:"span",className:"mrel"},"\u2208"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"["),(0,t.mdx)("span",{parentName:"span",className:"mord"},"0"),(0,t.mdx)("span",{parentName:"span",className:"mpunct"},","),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},"1"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},"]"))))),". ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"\u03b3")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\gamma")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.625em",verticalAlign:"-0.19444em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05556em"}},"\u03b3")))))," is initially drawn from ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mtext",{parentName:"mrow"},"Beta"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"a"),(0,t.mdx)("mo",{parentName:"mrow",separator:"true"},","),(0,t.mdx)("mi",{parentName:"mrow"},"b"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\text{Beta}(a, b)")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord text"},(0,t.mdx)("span",{parentName:"span",className:"mord"},"Beta")),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"a"),(0,t.mdx)("span",{parentName:"span",className:"mpunct"},","),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"b"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"))))),", and an appropriate distribution for ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"\u03b3")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\gamma")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.625em",verticalAlign:"-0.19444em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05556em"}},"\u03b3"))))),' is jointly learned with the rest of the model during inference ("Riemann manifold MALA", Section 5 of Girolami & Calderhead, 2011).'),(0,t.mdx)("p",null,"This proposer works for:"),(0,t.mdx)("ol",null,(0,t.mdx)("li",{parentName:"ol"},"Random variables with unconstrained space support."),(0,t.mdx)("li",{parentName:"ol"},"Random variables with constrained space support that are transformed into unconstrained space.")),(0,t.mdx)("p",null,"Subsequent sections will cover proposal distributions used in constrained spaces."),(0,t.mdx)("h2",{id:"half-space-nmc-proposer"},"Half-space NMC proposer"),(0,t.mdx)("p",null,"For random variables constrained with half-space support, NMC uses ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mtext",{parentName:"mrow"},"Gamma")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\text{Gamma}")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord text"},(0,t.mdx)("span",{parentName:"span",className:"mord"},"Gamma"))))))," as the base proposal distribution, and fits its parameters using local first- and second-order gradient information."),(0,t.mdx)("p",null,"Mathematically, it is: ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"q"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"."),(0,t.mdx)("mo",{parentName:"mrow"},"\u2223"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow"},"="),(0,t.mdx)("mtext",{parentName:"mrow"},"Gamma"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mn",{parentName:"mrow"},"1"),(0,t.mdx)("mo",{parentName:"mrow"},"\u2212"),(0,t.mdx)("msup",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msup"},"\u03b8"),(0,t.mdx)("mn",{parentName:"msup"},"2")),(0,t.mdx)("msup",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msup",mathvariant:"normal"},"\u2207"),(0,t.mdx)("mn",{parentName:"msup"},"2")),(0,t.mdx)("mi",{parentName:"mrow"},"log"),(0,t.mdx)("mo",{parentName:"mrow"},"\u2061"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03c0"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow",separator:"true"},","),(0,t.mdx)("mo",{parentName:"mrow"},"\u2212"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("msup",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msup",mathvariant:"normal"},"\u2207"),(0,t.mdx)("mn",{parentName:"msup"},"2")),(0,t.mdx)("mi",{parentName:"mrow"},"log"),(0,t.mdx)("mo",{parentName:"mrow"},"\u2061"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03c0"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow"},"\u2212"),(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2207"),(0,t.mdx)("mi",{parentName:"mrow"},"log"),(0,t.mdx)("mo",{parentName:"mrow"},"\u2061"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03c0"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"q(. \\mid \\theta)=\\text{Gamma}(1-\\theta^2\\nabla^2\\log\\pi(\\theta), -\\theta\\nabla^2\\log\\pi(\\theta)-\\nabla \\log\\pi(\\theta))")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"q"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord"},"."),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,t.mdx)("span",{parentName:"span",className:"mrel"},"\u2223"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,t.mdx)("span",{parentName:"span",className:"mrel"},"="),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord text"},(0,t.mdx)("span",{parentName:"span",className:"mord"},"Gamma")),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord"},"1"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}}),(0,t.mdx)("span",{parentName:"span",className:"mbin"},"\u2212"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1.064108em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.8141079999999999em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},"2")))))))),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord"},"\u2207"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.8141079999999999em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},"2")))))))),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mop"},"lo",(0,t.mdx)("span",{parentName:"span",style:{marginRight:"0.01389em"}},"g")),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"\u03c0"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mpunct"},","),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},"\u2212"),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord"},"\u2207"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.8141079999999999em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},"2")))))))),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mop"},"lo",(0,t.mdx)("span",{parentName:"span",style:{marginRight:"0.01389em"}},"g")),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"\u03c0"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}}),(0,t.mdx)("span",{parentName:"span",className:"mbin"},"\u2212"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},"\u2207"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mop"},"lo",(0,t.mdx)("span",{parentName:"span",style:{marginRight:"0.01389em"}},"g")),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"\u03c0"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"))))),"."),(0,t.mdx)("h2",{id:"simplex-proposer"},"Simplex proposer"),(0,t.mdx)("p",null,"For random variables constrained with simplex-valued support, NMC uses the ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mtext",{parentName:"mrow"},"Dirichlet")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\text{Dirichlet}")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.69444em",verticalAlign:"0em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord text"},(0,t.mdx)("span",{parentName:"span",className:"mord"},"Dirichlet"))))))," distribution as the base proposal distribution, and fits its parameters using local first- and second-order gradient information."),(0,t.mdx)("p",null,"For a ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"k")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"k")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.69444em",verticalAlign:"0em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03148em"}},"k"))))),"-dimensional simplex, the proposal distribution is ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"q"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"."),(0,t.mdx)("mo",{parentName:"mrow"},"\u2223"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow"},"="),(0,t.mdx)("mtext",{parentName:"mrow"},"Dirichlet"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"x"),(0,t.mdx)("mo",{parentName:"mrow",separator:"true"},";"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b1"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"q(. \\mid \\theta)=\\text{Dirichlet}(x;\\alpha)")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"q"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord"},"."),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,t.mdx)("span",{parentName:"span",className:"mrel"},"\u2223"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,t.mdx)("span",{parentName:"span",className:"mrel"},"="),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord text"},(0,t.mdx)("span",{parentName:"span",className:"mord"},"Dirichlet")),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"x"),(0,t.mdx)("span",{parentName:"span",className:"mpunct"},";"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.0037em"}},"\u03b1"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"))))),", where ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"\u03b1"),(0,t.mdx)("mo",{parentName:"mrow"},"\u2208"),(0,t.mdx)("msup",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msup",mathvariant:"double-struck"},"R"),(0,t.mdx)("mi",{parentName:"msup"},"k"))),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\alpha \\in \\mathbb{R}^k")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.5782em",verticalAlign:"-0.0391em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.0037em"}},"\u03b1"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,t.mdx)("span",{parentName:"span",className:"mrel"},"\u2208"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.849108em",verticalAlign:"0em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord mathbb"},"R")),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.849108em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k"))))))))))))," and ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("msub",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msub"},"\u03b1"),(0,t.mdx)("mi",{parentName:"msub"},"i")),(0,t.mdx)("mo",{parentName:"mrow"},"="),(0,t.mdx)("mn",{parentName:"mrow"},"1"),(0,t.mdx)("mo",{parentName:"mrow"},"\u2212"),(0,t.mdx)("msubsup",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msubsup"},"\u03b8"),(0,t.mdx)("mi",{parentName:"msubsup"},"i"),(0,t.mdx)("mn",{parentName:"msubsup"},"2")),(0,t.mdx)("mrow",{parentName:"mrow"},(0,t.mdx)("mo",{parentName:"mrow",fence:"true"},"("),(0,t.mdx)("msub",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msub",mathvariant:"normal"},"\u2207"),(0,t.mdx)("mrow",{parentName:"msub"},(0,t.mdx)("mi",{parentName:"mrow"},"i"),(0,t.mdx)("mi",{parentName:"mrow"},"i"))),(0,t.mdx)("mi",{parentName:"mrow"},"log"),(0,t.mdx)("mo",{parentName:"mrow"},"\u2061"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03c0"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow"},"\u2212"),(0,t.mdx)("mi",{parentName:"mrow"},(0,t.mdx)("munder",{parentName:"mi"},(0,t.mdx)("mo",{parentName:"munder"},(0,t.mdx)("mi",{parentName:"mo"},"max"),(0,t.mdx)("mo",{parentName:"mo"},"\u2061")),(0,t.mdx)("mrow",{parentName:"munder"},(0,t.mdx)("mi",{parentName:"mrow"},"i"),(0,t.mdx)("mo",{parentName:"mrow",mathvariant:"normal"},"\u2260"),(0,t.mdx)("mi",{parentName:"mrow"},"j")))),(0,t.mdx)("msubsup",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msubsup",mathvariant:"normal"},"\u2207"),(0,t.mdx)("mrow",{parentName:"msubsup"},(0,t.mdx)("mi",{parentName:"mrow"},"i"),(0,t.mdx)("mi",{parentName:"mrow"},"j")),(0,t.mdx)("mn",{parentName:"msubsup"},"2")),(0,t.mdx)("mi",{parentName:"mrow"},"log"),(0,t.mdx)("mo",{parentName:"mrow"},"\u2061"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03c0"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"\u03b8"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow",fence:"true"},")"))),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\alpha_i = 1-\\theta_i^2\\left(\\nabla_{ii}\\log\\pi(\\theta)-\\underset{i\\neq j}{\\max}\\nabla_{ij}^2\\log\\pi(\\theta)\\right)")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.58056em",verticalAlign:"-0.15em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.0037em"}},"\u03b1"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.31166399999999994em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.5500000000000003em",marginLeft:"-0.0037em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"i")))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.mdx)("span",{parentName:"span"})))))),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,t.mdx)("span",{parentName:"span",className:"mrel"},"="),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.72777em",verticalAlign:"-0.08333em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},"1"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}}),(0,t.mdx)("span",{parentName:"span",className:"mbin"},"\u2212"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"2.40003em",verticalAlign:"-0.95003em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.8141079999999999em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.441336em",marginLeft:"-0.02778em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"i"))),(0,t.mdx)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.258664em"}},(0,t.mdx)("span",{parentName:"span"})))))),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"minner"},(0,t.mdx)("span",{parentName:"span",className:"mopen delimcenter",style:{top:"0em"}},(0,t.mdx)("span",{parentName:"span",className:"delimsizing size3"},"(")),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord"},"\u2207"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.31166399999999994em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.5500000000000003em",marginLeft:"0em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"i"),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"i"))))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.mdx)("span",{parentName:"span"})))))),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mop"},"lo",(0,t.mdx)("span",{parentName:"span",style:{marginRight:"0.01389em"}},"g")),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"\u03c0"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}}),(0,t.mdx)("span",{parentName:"span",className:"mbin"},"\u2212"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mop op-limits"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.43055999999999994em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.3478920000000003em",marginLeft:"0em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"i"),(0,t.mdx)("span",{parentName:"span",className:"mrel mtight"},(0,t.mdx)("span",{parentName:"span",className:"mrel mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord vbox mtight"},(0,t.mdx)("span",{parentName:"span",className:"thinbox mtight"},(0,t.mdx)("span",{parentName:"span",className:"rlap mtight"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.8888799999999999em",verticalAlign:"-0.19444em"}}),(0,t.mdx)("span",{parentName:"span",className:"inner"},(0,t.mdx)("span",{parentName:"span",className:"mrel mtight"},"\ue020")),(0,t.mdx)("span",{parentName:"span",className:"fix"}))))),(0,t.mdx)("span",{parentName:"span",className:"mrel mtight"},"=")),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.05724em"}},"j")))),(0,t.mdx)("span",{parentName:"span",style:{top:"-3em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,t.mdx)("span",{parentName:"span"},(0,t.mdx)("span",{parentName:"span",className:"mop"},(0,t.mdx)("span",{parentName:"span",className:"mop"},"max"))))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.8882159999999999em"}},(0,t.mdx)("span",{parentName:"span"})))))),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord"},"\u2207"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.8141079999999999em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.441336em",marginLeft:"0em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"i"),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.05724em"}},"j")))),(0,t.mdx)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.394772em"}},(0,t.mdx)("span",{parentName:"span"})))))),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mop"},"lo",(0,t.mdx)("span",{parentName:"span",style:{marginRight:"0.01389em"}},"g")),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"\u03c0"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"\u03b8"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mclose delimcenter",style:{top:"0em"}},(0,t.mdx)("span",{parentName:"span",className:"delimsizing size3"},")"))))))),"."),(0,t.mdx)("h2",{id:"nmc-algorithm"},"NMC algorithm"),(0,t.mdx)("p",null,"Below is the NMC algorithm."),(0,t.mdx)("p",null,(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex-error",title:"ParseError: KaTeX parse error: Can't use function '$' in math mode at position 85: \u2026a_1...\\theta_k $\u0332",style:{color:"#cc0000"}},"\\textbf{Input:} \\text{ target density } \\pi \\text{ defined on } \\theta_1...\\theta_k $")),"\\textbf{Given: } a, b \\text{ (default 1, 1)}",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\textbf{repeat}",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad \\textbf{for } i=1\\ \\textbf{to}\\ k\\ \\textbf{do}:",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\quad\\text{Compute }\\nabla \\log\\pi(\\theta)\\ \\text{and}\\ \\nabla^2\\log\\pi(\\theta)\\ \\text{w.r.t. }\\theta_i",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\quad\\text{Compute }q_i(.|\\theta) \\text{ as explained above}",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\quad\\text{Sample }\\theta^",(0,t.mdx)("em",{parentName:"p"},"\\sim q_i(.|\\theta)",(0,t.mdx)("span",{parentName:"em",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\quad\\text{Set }\\theta^"),"_j=\\theta_j\\text{ for }i\\neq j",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\quad\\text{Compute }\\nabla \\log\\pi(\\theta^",(0,t.mdx)("em",{parentName:"p"},")\\text{ and }\\nabla^2\\log\\pi(\\theta^"),")\\text{ w.r.t. }\\theta_j^",(0,t.mdx)("em",{parentName:"p"},(0,t.mdx)("span",{parentName:"em",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\quad\\text{Compute }q_i(.|\\theta^"),")",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\quad\\alpha=\\frac{\\pi(\\theta^",(0,t.mdx)("em",{parentName:"p"},")q_i(\\theta|\\theta^"),")}{\\pi(\\theta)q_i(\\theta^",(0,t.mdx)("em",{parentName:"p"},"|\\theta)}",(0,t.mdx)("span",{parentName:"em",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\quad u\\sim \\text{Uniform}(0,1)",(0,t.mdx)("span",{parentName:"em",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\quad\\textbf{if }u<\\alpha\\textbf{ then}",(0,t.mdx)("span",{parentName:"em",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\quad\\quad\\theta=\\theta^"),(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\quad\\textbf{end if}",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\textbf{end for}",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\text{Output sample }\\theta",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\textbf{until }\\text{Desired number of samples}  $"),(0,t.mdx)("p",null,"Below is NMC algorithm with adaptive stage added to compute the learning rate parameters ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"a")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"a")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.43056em",verticalAlign:"0em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"a")))))," and ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"b")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"b")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.69444em",verticalAlign:"0em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"b")))))," for the ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mtext",{parentName:"mrow"},"Beta")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\text{Beta}")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord text"},(0,t.mdx)("span",{parentName:"span",className:"mord"},"Beta"))))))," distribution."),(0,t.mdx)("p",null,(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex-error",title:"ParseError: KaTeX parse error: Can't use function '$' in math mode at position 85: \u2026a_1...\\theta_k $\u0332",style:{color:"#cc0000"}},"\\textbf{Input:} \\text{ target density } \\pi \\text{ defined on } \\theta_1...\\theta_k $")),"\\textbf{Given: } a, b \\text{ (default 1, 1)}",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\textbf{repeat}",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad \\textbf{for } i=1\\ \\textbf{to}\\ k\\ \\textbf{do}:",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\quad\\text{Compute }\\nabla \\log\\pi(\\theta)\\ \\text{and}\\ \\nabla^2\\log\\pi(\\theta)\\ \\text{w.r.t. }\\theta_i",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\quad\\textbf{if }\\text{still in warm-up phase}\\textbf{ then}",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\qquad\\qquad \\text{Compute } a, b \\text{ from mean and variance of the warmup samples using method of moments} ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\qquad \\textbf{end if}",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\quad\\text{Sample }\\gamma\\sim \\text{Beta}(a,b)",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\quad\\text{Compute }q_i(.|\\theta) \\text{ as explained above}",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\quad\\text{Sample }\\theta^",(0,t.mdx)("em",{parentName:"p"},"\\sim q_i(.|\\theta)",(0,t.mdx)("span",{parentName:"em",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\quad\\text{Set }\\theta^"),"_j=\\theta_j\\text{ for }i\\neq j",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\quad\\text{Compute }\\nabla \\log\\pi(\\theta^",(0,t.mdx)("em",{parentName:"p"},")\\text{ and }\\nabla^2\\log\\pi(\\theta^"),")\\text{ w.r.t. }\\theta_j^",(0,t.mdx)("em",{parentName:"p"},(0,t.mdx)("span",{parentName:"em",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\quad\\text{Compute }q_i(.|\\theta^"),")",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\quad\\alpha=\\frac{\\pi(\\theta^",(0,t.mdx)("em",{parentName:"p"},")q_i(\\theta|\\theta^"),")}{\\pi(\\theta)q_i(\\theta^",(0,t.mdx)("em",{parentName:"p"},"|\\theta)}",(0,t.mdx)("span",{parentName:"em",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\quad u\\sim \\text{Uniform}(0,1)",(0,t.mdx)("span",{parentName:"em",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\quad\\textbf{if }u<\\alpha\\textbf{ then}",(0,t.mdx)("span",{parentName:"em",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\quad\\quad\\theta=\\theta^"),(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\quad\\textbf{end if}",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\textbf{end for}",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\quad\\text{Output sample }\\theta",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"}),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"}))),"\\textbf{until }\\text{Desired number of samples}  $"),(0,t.mdx)("h2",{id:"using-nmc"},"Using NMC"),(0,t.mdx)("p",null,"Here is how we call NMC, where ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"a")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"a")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.43056em",verticalAlign:"0em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"a")))))," and ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"b")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"b")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.69444em",verticalAlign:"0em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"b")))))," are ",(0,t.mdx)("inlineCode",{parentName:"p"},"real_space_alpha")," and ",(0,t.mdx)("inlineCode",{parentName:"p"},"real_space_beta"),"."),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-py"},"nmc = SingleSiteNewtonianMonteCarlo(real_space_alpha=1.0, real_space_beta=5.0)\nsamples = nmc.infer(\n  queries=...,\n  observations=...,\n  num_samples=...,\n  num_chains=...,\n)\n")),(0,t.mdx)("p",null,"To enable adaptive stage run, we can set ",(0,t.mdx)("inlineCode",{parentName:"p"},"num_adaptive_samples")," during inference."),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-py"},"nmc = SingleSiteNewtonianMonteCarlo(real_space_alpha=1.0, real_space_beta=5.0)\nsamples = nmc.infer(\n  queries=...,\n  observations=...,\n  num_samples=...,\n  num_chains=...,\n  num_adaptive_samples=num_warmup_samples,\n)\n")),(0,t.mdx)("p",null,"For random variables with half-space and simplex support, ",(0,t.mdx)("inlineCode",{parentName:"p"},"SingleSiteNewtonianMonteCarlo")," by default uses the half-space and simplex proposer. If a modeler is interested in transforming the random variables to real space and using the unconstrained proposer instead, we can write it as follows:"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-py"},"nmc = SingleSiteNewtonianMonteCarlo(`transform_type=``TransformType``.``DEFAULT`)\nsamples = nmc.infer(\n  queries=...,\n  observations=...,\n  num_samples=...,\n  num_chains=...,\n  num_adaptive_samples=num_warmup_samples,\n)\n")),(0,t.mdx)("hr",null),(0,t.mdx)("p",null,"Arora, N. S., Tehrani, N. K., Shah, K. D., Tingley, M., Li, Y. L., Torabi, N., Noursi, D., Masouleh, S. A., Lippert, E., and Meijer, E. (2020). Newtonian monte carlo: single-site mcmc meets second-order gradient methods. ",(0,t.mdx)("em",{parentName:"p"},"arXiv:2001.05567"),"."),(0,t.mdx)("p",null,"Metropolis, N., Rosenbluth, A., Rosenbluth, M., Teller, A., and Teller, E. (1953). \u201cEquations of state calculations by fast computing machines.\u201d ",(0,t.mdx)("em",{parentName:"p"},"J. Chem. Phys."),", 21(6): 1087\u20131092."),(0,t.mdx)("p",null,"Robert, G., and Tweedie, R. 1996. Exponential convergence of Langevin diffusions and their discrete approximation. ",(0,t.mdx)("em",{parentName:"p"},"Bernoulli")," 2:341\u2013363."),(0,t.mdx)("p",null,"Girolami, M., and Calderhead, B. (2011). \u201cRiemann Manifold Langevin and Hamiltonian Monte Carlo Methods: Riemann Manifold Langevin and Hamiltonian Monte Carlo Methods.\u201d Journal of the Royal Statistical Society: Series B (Statistical Methodology) 73, no. 2 (March 2011): 123\u2013214. ",(0,t.mdx)("a",{parentName:"p",href:"https://doi.org/10.1111/j.1467-9868.2010.00765.x"},"https://doi.org/10.1111/j.1467-9868.2010.00765.x"),"."))}x.isMDXComponent=!0}}]);