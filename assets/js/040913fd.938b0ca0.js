"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[7785],{3905:function(a,e,m){m.r(e),m.d(e,{MDXContext:function(){return i},MDXProvider:function(){return o},mdx:function(){return h},useMDXComponents:function(){return d},withMDXComponents:function(){return N}});var s=m(67294);function n(a,e,m){return e in a?Object.defineProperty(a,e,{value:m,enumerable:!0,configurable:!0,writable:!0}):a[e]=m,a}function t(){return t=Object.assign||function(a){for(var e=1;e<arguments.length;e++){var m=arguments[e];for(var s in m)Object.prototype.hasOwnProperty.call(m,s)&&(a[s]=m[s])}return a},t.apply(this,arguments)}function p(a,e){var m=Object.keys(a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(a);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),m.push.apply(m,s)}return m}function r(a){for(var e=1;e<arguments.length;e++){var m=null!=arguments[e]?arguments[e]:{};e%2?p(Object(m),!0).forEach((function(e){n(a,e,m[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(m)):p(Object(m)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(m,e))}))}return a}function l(a,e){if(null==a)return{};var m,s,n=function(a,e){if(null==a)return{};var m,s,n={},t=Object.keys(a);for(s=0;s<t.length;s++)m=t[s],e.indexOf(m)>=0||(n[m]=a[m]);return n}(a,e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(a);for(s=0;s<t.length;s++)m=t[s],e.indexOf(m)>=0||Object.prototype.propertyIsEnumerable.call(a,m)&&(n[m]=a[m])}return n}var i=s.createContext({}),N=function(a){return function(e){var m=d(e.components);return s.createElement(a,t({},e,{components:m}))}},d=function(a){var e=s.useContext(i),m=e;return a&&(m="function"==typeof a?a(e):r(r({},e),a)),m},o=function(a){var e=d(a.components);return s.createElement(i.Provider,{value:e},a.children)},c={inlineCode:"code",wrapper:function(a){var e=a.children;return s.createElement(s.Fragment,{},e)}},x=s.forwardRef((function(a,e){var m=a.components,n=a.mdxType,t=a.originalType,p=a.parentName,i=l(a,["components","mdxType","originalType","parentName"]),N=d(m),o=n,x=N["".concat(p,".").concat(o)]||N[o]||c[o]||t;return m?s.createElement(x,r(r({ref:e},i),{},{components:m})):s.createElement(x,r({ref:e},i))}));function h(a,e){var m=arguments,n=e&&e.mdxType;if("string"==typeof a||n){var t=m.length,p=new Array(t);p[0]=x;var r={};for(var l in e)hasOwnProperty.call(e,l)&&(r[l]=e[l]);r.originalType=a,r.mdxType="string"==typeof a?a:n,p[1]=r;for(var i=2;i<t;i++)p[i]=m[i];return s.createElement.apply(null,p)}return s.createElement.apply(null,m)}x.displayName="MDXCreateElement"},98810:function(a,e,m){m.r(e),m.d(e,{frontMatter:function(){return r},contentTitle:function(){return l},metadata:function(){return i},toc:function(){return N},default:function(){return o}});var s=m(87462),n=m(63366),t=(m(67294),m(3905)),p=["components"],r={id:"hamiltonian_monte_carlo",title:"Hamiltonian Monte Carlo and Variations",sidebar_label:"Hamiltoniam Monte Carlo"},l=void 0,i={unversionedId:"framework_topics/inference/hamiltonian_monte_carlo",id:"framework_topics/inference/hamiltonian_monte_carlo",isDocsHomePage:!1,title:"Hamiltonian Monte Carlo and Variations",description:"Hamiltonian Monte Carlo",source:"@site/../docs/framework_topics/inference/hamiltonian_monte_carlo.md",sourceDirName:"framework_topics/inference",slug:"/framework_topics/inference/hamiltonian_monte_carlo",permalink:"/docs/framework_topics/inference/hamiltonian_monte_carlo",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/../docs/framework_topics/inference/hamiltonian_monte_carlo.md",tags:[],version:"current",frontMatter:{id:"hamiltonian_monte_carlo",title:"Hamiltonian Monte Carlo and Variations",sidebar_label:"Hamiltoniam Monte Carlo"},sidebar:"someSidebar",previous:{title:"Single-site ancestral Metropolis-Hastings",permalink:"/docs/framework_topics/inference/ancestral_metropolis_hastings"},next:{title:"inference",permalink:"/docs/framework_topics/inference/inference"}},N=[{value:"Hamiltonian Monte Carlo",id:"hamiltonian-monte-carlo",children:[{value:"Algorithm Overview",id:"algorithm-overview",children:[],level:3},{value:"HMC in Bean Machine",id:"hmc-in-bean-machine",children:[],level:3}],level:2},{value:"Adaptive Hamiltonian Monte Carlo",id:"adaptive-hamiltonian-monte-carlo",children:[],level:2},{value:"No-U-Turn Sampler",id:"no-u-turn-sampler",children:[],level:2}],d={toc:N};function o(a){var e=a.components,m=(0,n.Z)(a,p);return(0,t.mdx)("wrapper",(0,s.Z)({},d,m,{components:e,mdxType:"MDXLayout"}),(0,t.mdx)("h2",{id:"hamiltonian-monte-carlo"},"Hamiltonian Monte Carlo"),(0,t.mdx)("p",null,"Hamiltonian Monte Carlo (HMC) is a sampling algorithm for differentiable random variables which uses Hamiltonian dynamics. By randomly drawing a momentum for the kinetic energy and treating the true posterior as the potential energy, HMC is able to simulate trajectories which explore the space. Intuitively, this can be viewed as starting with a marble at a point inside a bowl, flicking the marble in a random direction, and then following the marble as it rolls around. The position of the marble represents the sample, the flick represents the momentum, and the shape of the bowl in combination with the force of gravity represents our true posterior."),(0,t.mdx)("h3",{id:"algorithm-overview"},"Algorithm Overview"),(0,t.mdx)("p",null,"More formally, HMC applies Hamiltonian dynamics to the state space by introducing an auxiliary momentum variable ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"p")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"p")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.625em",verticalAlign:"-0.19444em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"p"))))),". The Hamiltonian can then be written as\n",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"H"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"q"),(0,t.mdx)("mo",{parentName:"mrow",separator:"true"},","),(0,t.mdx)("mi",{parentName:"mrow"},"p"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow"},"="),(0,t.mdx)("mi",{parentName:"mrow"},"U"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"q"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow"},"+"),(0,t.mdx)("mi",{parentName:"mrow"},"K"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"p"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"H(q, p) = U(q) + K(p)")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.08125em"}},"H"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"q"),(0,t.mdx)("span",{parentName:"span",className:"mpunct"},","),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"p"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,t.mdx)("span",{parentName:"span",className:"mrel"},"="),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"U"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"q"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}}),(0,t.mdx)("span",{parentName:"span",className:"mbin"},"+"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07153em"}},"K"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"p"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"))))),"\nwhere ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"U")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"U")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"U")))))," and ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"K")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"K")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07153em"}},"K")))))," represent the potential and kinetic energy respectively."),(0,t.mdx)("p",null,"The potential energy represents the shape of the posterior distribution, and is defined by\n",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"U"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"q"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow"},"="),(0,t.mdx)("mo",{parentName:"mrow"},"\u2212"),(0,t.mdx)("mi",{parentName:"mrow"},"log"),(0,t.mdx)("mo",{parentName:"mrow"},"\u2061"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"["),(0,t.mdx)("mi",{parentName:"mrow"},"\u03c0"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"q"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mi",{parentName:"mrow"},"L"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"q"),(0,t.mdx)("mo",{parentName:"mrow"},"\u2223"),(0,t.mdx)("mi",{parentName:"mrow"},"D"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"]")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"U(q) = -\\log[\\pi(q)L(q\\mid D)]")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"U"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"q"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,t.mdx)("span",{parentName:"span",className:"mrel"},"="),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},"\u2212"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.16666666666666666em"}}),(0,t.mdx)("span",{parentName:"span",className:"mop"},"lo",(0,t.mdx)("span",{parentName:"span",style:{marginRight:"0.01389em"}},"g")),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"["),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"\u03c0"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"q"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"L"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"q"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,t.mdx)("span",{parentName:"span",className:"mrel"},"\u2223"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"D"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},"]"))))),"\nThe kinetic energy is defined using the momentum variable ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"p")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"p")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.625em",verticalAlign:"-0.19444em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"p")))))," as well as the covariance matrix ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"\u03a3")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\Sigma")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},"\u03a3"))))),".\n",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"K"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"p"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow"},"="),(0,t.mdx)("msup",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msup"},"p"),(0,t.mdx)("mi",{parentName:"msup"},"T")),(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"\u03a3"),(0,t.mdx)("mi",{parentName:"mrow"},"p"),(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"/"),(0,t.mdx)("mn",{parentName:"mrow"},"2")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"K(p) = p^T\\Sigma p/2")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07153em"}},"K"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"p"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,t.mdx)("span",{parentName:"span",className:"mrel"},"="),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1.0913309999999998em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"p"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.8413309999999999em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.13889em"}},"T")))))))),(0,t.mdx)("span",{parentName:"span",className:"mord"},"\u03a3"),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"p"),(0,t.mdx)("span",{parentName:"span",className:"mord"},"/"),(0,t.mdx)("span",{parentName:"span",className:"mord"},"2"))))),"\nWe can then simulate the trajectory using the following forms of Hamilton's equations:\n",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mfrac",{parentName:"mrow"},(0,t.mdx)("mrow",{parentName:"mfrac"},(0,t.mdx)("mi",{parentName:"mrow"},"d"),(0,t.mdx)("msub",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msub"},"q"),(0,t.mdx)("mi",{parentName:"msub"},"i"))),(0,t.mdx)("mrow",{parentName:"mfrac"},(0,t.mdx)("mi",{parentName:"mrow"},"d"),(0,t.mdx)("mi",{parentName:"mrow"},"t"))),(0,t.mdx)("mo",{parentName:"mrow"},"="),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"["),(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"\u03a3"),(0,t.mdx)("mi",{parentName:"mrow"},"p"),(0,t.mdx)("msub",{parentName:"mrow"},(0,t.mdx)("mo",{parentName:"msub",stretchy:"false"},"]"),(0,t.mdx)("mi",{parentName:"msub"},"i"))),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\frac{dq_i}{dt} = [\\Sigma p]_i")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1.277216em",verticalAlign:"-0.345em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mopen nulldelimiter"}),(0,t.mdx)("span",{parentName:"span",className:"mfrac"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.9322159999999999em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.6550000000000002em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"d"),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"t")))),(0,t.mdx)("span",{parentName:"span",style:{top:"-3.23em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,t.mdx)("span",{parentName:"span",className:"frac-line",style:{borderBottomWidth:"0.04em"}})),(0,t.mdx)("span",{parentName:"span",style:{top:"-3.446108em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"d"),(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03588em"}},"q"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.3280857142857143em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.357em",marginLeft:"-0.03588em",marginRight:"0.07142857142857144em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.5em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size3 size1 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"i")))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.143em"}},(0,t.mdx)("span",{parentName:"span"})))))))))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.345em"}},(0,t.mdx)("span",{parentName:"span"}))))),(0,t.mdx)("span",{parentName:"span",className:"mclose nulldelimiter"})),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,t.mdx)("span",{parentName:"span",className:"mrel"},"="),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"["),(0,t.mdx)("span",{parentName:"span",className:"mord"},"\u03a3"),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"p"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},(0,t.mdx)("span",{parentName:"span",className:"mclose"},"]"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.31166399999999994em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.5500000000000003em",marginLeft:"0em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"i")))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.mdx)("span",{parentName:"span"})))))))))),"\n",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mfrac",{parentName:"mrow"},(0,t.mdx)("mrow",{parentName:"mfrac"},(0,t.mdx)("mi",{parentName:"mrow"},"d"),(0,t.mdx)("msub",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msub"},"p"),(0,t.mdx)("mi",{parentName:"msub"},"i"))),(0,t.mdx)("mrow",{parentName:"mfrac"},(0,t.mdx)("mi",{parentName:"mrow"},"d"),(0,t.mdx)("mi",{parentName:"mrow"},"t"))),(0,t.mdx)("mo",{parentName:"mrow"},"="),(0,t.mdx)("mo",{parentName:"mrow"},"\u2212"),(0,t.mdx)("mfrac",{parentName:"mrow"},(0,t.mdx)("mrow",{parentName:"mfrac"},(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2202"),(0,t.mdx)("mi",{parentName:"mrow"},"U")),(0,t.mdx)("mrow",{parentName:"mfrac"},(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2202"),(0,t.mdx)("msub",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msub"},"q"),(0,t.mdx)("mi",{parentName:"msub"},"i"))))),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\frac{dp_i}{dt} = -\\frac{\\partial U}{\\partial q_i}")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1.277216em",verticalAlign:"-0.345em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mopen nulldelimiter"}),(0,t.mdx)("span",{parentName:"span",className:"mfrac"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.9322159999999999em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.6550000000000002em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"d"),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"t")))),(0,t.mdx)("span",{parentName:"span",style:{top:"-3.23em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,t.mdx)("span",{parentName:"span",className:"frac-line",style:{borderBottomWidth:"0.04em"}})),(0,t.mdx)("span",{parentName:"span",style:{top:"-3.446108em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"d"),(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"p"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.3280857142857143em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.357em",marginLeft:"0em",marginRight:"0.07142857142857144em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.5em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size3 size1 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"i")))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.143em"}},(0,t.mdx)("span",{parentName:"span"})))))))))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.345em"}},(0,t.mdx)("span",{parentName:"span"}))))),(0,t.mdx)("span",{parentName:"span",className:"mclose nulldelimiter"})),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,t.mdx)("span",{parentName:"span",className:"mrel"},"="),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1.3612159999999998em",verticalAlign:"-0.481108em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},"\u2212"),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mopen nulldelimiter"}),(0,t.mdx)("span",{parentName:"span",className:"mfrac"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.8801079999999999em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.6550000000000002em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight",style:{marginRight:"0.05556em"}},"\u2202"),(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03588em"}},"q"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.3280857142857143em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.357em",marginLeft:"-0.03588em",marginRight:"0.07142857142857144em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.5em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size3 size1 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"i")))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.143em"}},(0,t.mdx)("span",{parentName:"span"}))))))))),(0,t.mdx)("span",{parentName:"span",style:{top:"-3.23em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,t.mdx)("span",{parentName:"span",className:"frac-line",style:{borderBottomWidth:"0.04em"}})),(0,t.mdx)("span",{parentName:"span",style:{top:"-3.394em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight",style:{marginRight:"0.05556em"}},"\u2202"),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.10903em"}},"U"))))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.481108em"}},(0,t.mdx)("span",{parentName:"span"}))))),(0,t.mdx)("span",{parentName:"span",className:"mclose nulldelimiter"}))))))),(0,t.mdx)("p",null,"However, because these equations cannot be directly computed, Bean Machine uses the leapfrog method to approximate the trajectory. For leapfrog step at time ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"t")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"t")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.61508em",verticalAlign:"0em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"t")))))," of size ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"\u03f5")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\epsilon")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.43056em",verticalAlign:"0em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"\u03f5"))))),", we take a half-step for momentum and a full-step for position using the updated momentum, and finally another half step for the momentum.\n",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("msub",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msub"},"p"),(0,t.mdx)("mi",{parentName:"msub"},"i")),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"t"),(0,t.mdx)("mo",{parentName:"mrow"},"+"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03f5"),(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"/"),(0,t.mdx)("mn",{parentName:"mrow"},"2"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow"},"="),(0,t.mdx)("mi",{parentName:"mrow"},"p"),(0,t.mdx)("mo",{parentName:"mrow"},"\u2212"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"\u03f5"),(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"/"),(0,t.mdx)("mn",{parentName:"mrow"},"2"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mfrac",{parentName:"mrow"},(0,t.mdx)("mrow",{parentName:"mfrac"},(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2202"),(0,t.mdx)("mi",{parentName:"mrow"},"U")),(0,t.mdx)("mrow",{parentName:"mfrac"},(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2202"),(0,t.mdx)("msub",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msub"},"q"),(0,t.mdx)("mi",{parentName:"msub"},"i")))),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"q"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"t"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"p_i(t + \\epsilon/2) = p - (\\epsilon/2)\\frac{\\partial U}{\\partial q_i}(q(t))")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"p"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.31166399999999994em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.5500000000000003em",marginLeft:"0em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"i")))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.mdx)("span",{parentName:"span"})))))),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}}),(0,t.mdx)("span",{parentName:"span",className:"mbin"},"+"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"\u03f5"),(0,t.mdx)("span",{parentName:"span",className:"mord"},"/"),(0,t.mdx)("span",{parentName:"span",className:"mord"},"2"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,t.mdx)("span",{parentName:"span",className:"mrel"},"="),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.7777700000000001em",verticalAlign:"-0.19444em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"p"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}}),(0,t.mdx)("span",{parentName:"span",className:"mbin"},"\u2212"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1.3612159999999998em",verticalAlign:"-0.481108em"}}),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"\u03f5"),(0,t.mdx)("span",{parentName:"span",className:"mord"},"/"),(0,t.mdx)("span",{parentName:"span",className:"mord"},"2"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mopen nulldelimiter"}),(0,t.mdx)("span",{parentName:"span",className:"mfrac"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.8801079999999999em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.6550000000000002em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight",style:{marginRight:"0.05556em"}},"\u2202"),(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03588em"}},"q"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.3280857142857143em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.357em",marginLeft:"-0.03588em",marginRight:"0.07142857142857144em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.5em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size3 size1 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"i")))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.143em"}},(0,t.mdx)("span",{parentName:"span"}))))))))),(0,t.mdx)("span",{parentName:"span",style:{top:"-3.23em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,t.mdx)("span",{parentName:"span",className:"frac-line",style:{borderBottomWidth:"0.04em"}})),(0,t.mdx)("span",{parentName:"span",style:{top:"-3.394em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight",style:{marginRight:"0.05556em"}},"\u2202"),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.10903em"}},"U"))))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.481108em"}},(0,t.mdx)("span",{parentName:"span"}))))),(0,t.mdx)("span",{parentName:"span",className:"mclose nulldelimiter"})),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"q"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"))))),"\n",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("msub",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msub"},"q"),(0,t.mdx)("mi",{parentName:"msub"},"i")),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"t"),(0,t.mdx)("mo",{parentName:"mrow"},"+"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03f5"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow"},"="),(0,t.mdx)("msub",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msub"},"q"),(0,t.mdx)("mi",{parentName:"msub"},"i")),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"t"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow"},"+"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03f5"),(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"\u03a3"),(0,t.mdx)("msub",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msub"},"p"),(0,t.mdx)("mi",{parentName:"msub"},"i")),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"t"),(0,t.mdx)("mo",{parentName:"mrow"},"+"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03f5"),(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"/"),(0,t.mdx)("mn",{parentName:"mrow"},"2"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"q_i(t + \\epsilon) = q_i(t) + \\epsilon \\Sigma p_i(t + \\epsilon/2)")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"q"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.31166399999999994em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.5500000000000003em",marginLeft:"-0.03588em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"i")))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.mdx)("span",{parentName:"span"})))))),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}}),(0,t.mdx)("span",{parentName:"span",className:"mbin"},"+"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"\u03f5"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,t.mdx)("span",{parentName:"span",className:"mrel"},"="),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"q"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.31166399999999994em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.5500000000000003em",marginLeft:"-0.03588em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"i")))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.mdx)("span",{parentName:"span"})))))),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}}),(0,t.mdx)("span",{parentName:"span",className:"mbin"},"+"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"\u03f5"),(0,t.mdx)("span",{parentName:"span",className:"mord"},"\u03a3"),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"p"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.31166399999999994em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.5500000000000003em",marginLeft:"0em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"i")))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.mdx)("span",{parentName:"span"})))))),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}}),(0,t.mdx)("span",{parentName:"span",className:"mbin"},"+"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"\u03f5"),(0,t.mdx)("span",{parentName:"span",className:"mord"},"/"),(0,t.mdx)("span",{parentName:"span",className:"mord"},"2"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"))))),"\n",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("msub",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msub"},"p"),(0,t.mdx)("mi",{parentName:"msub"},"i")),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"t"),(0,t.mdx)("mo",{parentName:"mrow"},"+"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03f5"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow"},"="),(0,t.mdx)("msub",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msub"},"p"),(0,t.mdx)("mi",{parentName:"msub"},"i")),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"t"),(0,t.mdx)("mo",{parentName:"mrow"},"+"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03f5"),(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"/"),(0,t.mdx)("mn",{parentName:"mrow"},"2"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow"},"\u2212"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"\u03f5"),(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"/"),(0,t.mdx)("mn",{parentName:"mrow"},"2"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mfrac",{parentName:"mrow"},(0,t.mdx)("mrow",{parentName:"mfrac"},(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2202"),(0,t.mdx)("mi",{parentName:"mrow"},"U")),(0,t.mdx)("mrow",{parentName:"mfrac"},(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2202"),(0,t.mdx)("msub",{parentName:"mrow"},(0,t.mdx)("mi",{parentName:"msub"},"q"),(0,t.mdx)("mi",{parentName:"msub"},"i")))),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"q"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.mdx)("mi",{parentName:"mrow"},"t"),(0,t.mdx)("mo",{parentName:"mrow"},"+"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03f5"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"p_i(t + \\epsilon) = p_i(t + \\epsilon/2) - (\\epsilon/2)\\frac{\\partial U}{\\partial q_i}(q(t + \\epsilon))")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"p"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.31166399999999994em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.5500000000000003em",marginLeft:"0em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"i")))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.mdx)("span",{parentName:"span"})))))),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}}),(0,t.mdx)("span",{parentName:"span",className:"mbin"},"+"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"\u03f5"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,t.mdx)("span",{parentName:"span",className:"mrel"},"="),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"p"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.31166399999999994em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.5500000000000003em",marginLeft:"0em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"i")))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.mdx)("span",{parentName:"span"})))))),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}}),(0,t.mdx)("span",{parentName:"span",className:"mbin"},"+"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"\u03f5"),(0,t.mdx)("span",{parentName:"span",className:"mord"},"/"),(0,t.mdx)("span",{parentName:"span",className:"mord"},"2"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}}),(0,t.mdx)("span",{parentName:"span",className:"mbin"},"\u2212"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1.3612159999999998em",verticalAlign:"-0.481108em"}}),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"\u03f5"),(0,t.mdx)("span",{parentName:"span",className:"mord"},"/"),(0,t.mdx)("span",{parentName:"span",className:"mord"},"2"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mopen nulldelimiter"}),(0,t.mdx)("span",{parentName:"span",className:"mfrac"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.8801079999999999em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.6550000000000002em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight",style:{marginRight:"0.05556em"}},"\u2202"),(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03588em"}},"q"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.3280857142857143em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-2.357em",marginLeft:"-0.03588em",marginRight:"0.07142857142857144em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.5em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size3 size1 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight"},"i")))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.143em"}},(0,t.mdx)("span",{parentName:"span"}))))))))),(0,t.mdx)("span",{parentName:"span",style:{top:"-3.23em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,t.mdx)("span",{parentName:"span",className:"frac-line",style:{borderBottomWidth:"0.04em"}})),(0,t.mdx)("span",{parentName:"span",style:{top:"-3.394em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mtight",style:{marginRight:"0.05556em"}},"\u2202"),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.10903em"}},"U"))))),(0,t.mdx)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.481108em"}},(0,t.mdx)("span",{parentName:"span"}))))),(0,t.mdx)("span",{parentName:"span",className:"mclose nulldelimiter"})),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"q"),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"("),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}}),(0,t.mdx)("span",{parentName:"span",className:"mbin"},"+"),(0,t.mdx)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"\u03f5"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},")")))))),(0,t.mdx)("p",null,"With target path length ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"\u03bb")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\lambda")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.69444em",verticalAlign:"0em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"\u03bb")))))," and step size ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"\u03f5")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\epsilon")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.43056em",verticalAlign:"0em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"\u03f5"))))),", the number of leapfrog steps is calculated by ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"\u2308"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03bb"),(0,t.mdx)("mi",{parentName:"mrow",mathvariant:"normal"},"/"),(0,t.mdx)("mi",{parentName:"mrow"},"\u03f5"),(0,t.mdx)("mo",{parentName:"mrow",stretchy:"false"},"\u2309")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\lceil\\lambda / \\epsilon\\rceil")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.mdx)("span",{parentName:"span",className:"mopen"},"\u2308"),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"\u03bb"),(0,t.mdx)("span",{parentName:"span",className:"mord"},"/"),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal"},"\u03f5"),(0,t.mdx)("span",{parentName:"span",className:"mclose"},"\u2309"))))),". The final sample for ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"q")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"q")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.625em",verticalAlign:"-0.19444em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"q")))))," is chosen by the value of ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"q")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"q")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.625em",verticalAlign:"-0.19444em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"q")))))," after the last leapfrog step."),(0,t.mdx)("p",null,"Due to the discretization, the resulting trajectory will contain numerical errors. To account for the error, a Metropolis Hastings accept / reject will be applied and the value for ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"q")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"q")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.625em",verticalAlign:"-0.19444em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"q")))))," will be updated depending accordingly."),(0,t.mdx)("h3",{id:"hmc-in-bean-machine"},"HMC in Bean Machine"),(0,t.mdx)("p",null,"In Bean Machine, inference using HMC can be specified as an inference method for all variables in the model"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-py"},"import beanmachine.ppl as bm\nhmc = bm.SingleSiteHamiltonianMonteCarlo(path_length=1.0, step_size=0.1);\n")),(0,t.mdx)("p",null,"or through compositional inference to select HMC for specific variables"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-py"},"hmc = bm.CompositionalInference(\n  {x: SingleSiteHamiltonianMonteCarloProposer(path_length=1.0, step_size=0.1)}\n);\n")),(0,t.mdx)("p",null,"All the above will only update one random variable at a time per iteration. To resample all variables at once\nwe use"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-py"},"hmc = bm.GlobalHamiltonianMonteCarlo(trajectory_length=1.0)\n")),(0,t.mdx)("p",null,"The parameters for HMC have to be carefully selected, as different parameters may lead to vastly different behavior."),(0,t.mdx)("ul",null,(0,t.mdx)("li",{parentName:"ul"},(0,t.mdx)("p",{parentName:"li"},"Path length:\nBecause the samples should be minimally correlated, it is ideal to follow the trajectory for long path lengths. However, distributions may have periodic behavior, and long path lengths may waste computation. The ideal path length is the minimal path length where the samples have low correlation.")),(0,t.mdx)("li",{parentName:"ul"},(0,t.mdx)("p",{parentName:"li"},"Step Size:\nIf the Hamiltonian equations were followed perfectly, all samples would be accepted. However, error is introduced into the system during the discretization of Hamilton equations. The larger the step size, the worse the final approximation will be; however, if the steps are too small, the number of steps needed as well as the overall runtime of the algorithm will increase.")),(0,t.mdx)("li",{parentName:"ul"},(0,t.mdx)("p",{parentName:"li"},"Covariance Matrix (Mass Matrix):\nIf there is significant correlations between the variables and the covariance matrix is not properly tuned, we will need to make smaller steps to get samples that are likely to be accepted."))),(0,t.mdx)("h2",{id:"adaptive-hamiltonian-monte-carlo"},"Adaptive Hamiltonian Monte Carlo"),(0,t.mdx)("p",null,"Adaptive HMC requires an adaptive phase, where we use the HMC algorithm to generate samples while tuning its own step size and covariance matrix. Adaptive HMC provides two main improvements over HMC."),(0,t.mdx)("ul",null,(0,t.mdx)("li",{parentName:"ul"},"Users do not have to specify a step size:\nThe ideal acceptance rate for HMC is 65%, where step size is aggressive enough to minimize computation costs, but small enough that the discretization does not introduce too much error into the system.\nDuring the adaptive phase, the step size is adjusted based on the acceptance probability of the samples. If the acceptance rate is above the ideal acceptance rate, then Bean Machine is being too careful and discretizing in steps that are too small; therefore, the step size should be increased. If the acceptance rate is too low, then the step size should be decreased. We follow the Robbins Munro stochastic approximation method, where earlier iterations within the adaptive phase have a larger influence over the step size than later iterations."),(0,t.mdx)("li",{parentName:"ul"},"HMC can take different step sizes in different dimensions:\nDuring the adaptive phase, tune the momentum in each dimension is tuned depending on the covariance of the previously accepted samples. The amount of momentum used is controlled by the covariance matrix, which allows HMC to move through the dimensions at different rates.\nThe estimated covariance matrix is adjusted based on the covariance of the samples. Since the ideal covariance matrix is the true covariance, we can approximate this during the adaptive phase by using the covariance of the samples.")),(0,t.mdx)("p",null,"Once the adaptive phase ends, we no longer update our parameters, and the original HMC algorithm is used to generate new samples. Since the samples generated during the adaptive phase use untuned parameters, they may not be of the highest quality and are not returned by default."),(0,t.mdx)("p",null,"Adaptive HMC will be used when no step size is specified."),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-py"},"hmc = bm.SingleSiteHamiltonianMonteCarlo(path_length=1.0);\n")),(0,t.mdx)("p",null,"During inference, make sure to specify the number of adaptive samples, else no adaptation will occur."),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-py"},"hmc.infer(queries, observations, num_samples, num_chains, num_adaptive_samples=1000)\n")),(0,t.mdx)("p",null,"The global variant",(0,t.mdx)("inlineCode",{parentName:"p"},"GlobalHamiltonianMonteCarlo")," comes with a few more options for tuning the step size and acceptance probability."),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-py"},"hmc = bm.GlobalHamiltonianMonteCarlo(\n    trajectory_length=1.0,\n    initial_step_size=1.0\n    adapt_step_size=True,\n    adapt_mass_matrix=True,\n    target_accept_prob=0.8,\n)\n")),(0,t.mdx)("p",null,"These arguments allow us to decide if we want to tune the step size ",(0,t.mdx)("inlineCode",{parentName:"p"},"adjust_step_size")," or covariance matrix ",(0,t.mdx)("inlineCode",{parentName:"p"},"adapt_mass_matrix"),".  The ",(0,t.mdx)("inlineCode",{parentName:"p"},"target_accept_prob")," argument indicates the acceptance probability which should be targeted by the step size tuning algorithm. While the optimal value is 65.1% higher values have been show to be more robust leading to a default of 0.8."),(0,t.mdx)("h2",{id:"no-u-turn-sampler"},"No-U-Turn Sampler"),(0,t.mdx)("p",null,"The No-U-Turn Samplers (NUTS) dynamically determines when the path starts looping backwards. In combination with the improvements from Adaptive HMC, this allow Bean Machine to automatically find the best step size and path length without requiring any user-tuned parameters."),(0,t.mdx)("p",null,"NUTS decides on an optimal path length by building a binary tree where each path through the binary tree represents the trajectory of our particle. Each node at depth ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("mi",{parentName:"mrow"},"j")),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"j")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.85396em",verticalAlign:"-0.19444em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05724em"}},"j")))))," representing going ",(0,t.mdx)("span",{parentName:"p",className:"math math-inline"},(0,t.mdx)("span",{parentName:"span",className:"katex"},(0,t.mdx)("span",{parentName:"span",className:"katex-mathml"},(0,t.mdx)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.mdx)("semantics",{parentName:"math"},(0,t.mdx)("mrow",{parentName:"semantics"},(0,t.mdx)("msup",{parentName:"mrow"},(0,t.mdx)("mn",{parentName:"msup"},"2"),(0,t.mdx)("mi",{parentName:"msup"},"j"))),(0,t.mdx)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"2^j")))),(0,t.mdx)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.mdx)("span",{parentName:"span",className:"base"},(0,t.mdx)("span",{parentName:"span",className:"strut",style:{height:"0.824664em",verticalAlign:"0em"}}),(0,t.mdx)("span",{parentName:"span",className:"mord"},(0,t.mdx)("span",{parentName:"span",className:"mord"},"2"),(0,t.mdx)("span",{parentName:"span",className:"msupsub"},(0,t.mdx)("span",{parentName:"span",className:"vlist-t"},(0,t.mdx)("span",{parentName:"span",className:"vlist-r"},(0,t.mdx)("span",{parentName:"span",className:"vlist",style:{height:"0.824664em"}},(0,t.mdx)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,t.mdx)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.mdx)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.mdx)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.05724em"}},"j"))))))))))))," steps forwards or backwards. This binary tree is adaptively grown until either hitting a max depth size, or due to discretization error we start proposing moves with too low of a probability."),(0,t.mdx)("p",null,"Bean Machine comes with two variants of NUTS, a single-site implementation that only updates one variable at a time and another that updates\nall the variables at once."),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-py"},"nuts = bm.SingleSiteNoUTurnSampler(use_dense_mass_matrix = True)\nnuts.infer(queries, observations, num_samples, num_chains, num_adaptive_samples=1000)\n")),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-py"},"nuts = bm.GlobalNoUTurnSampler(\n    max_tree_depth = 10,\n    max_delta_energy = 1000.0,\n    initial_step_size = 1.0,\n    adapt_step_size = True,\n    adapt_mass_matrix = True,\n    multinomial_sampling = True,\n    target_accept_prob = 0.8)\n\nnuts.infer(queries, observations, num_samples, num_chains, num_adaptive_samples=1000);\n")),(0,t.mdx)("p",null,"The ",(0,t.mdx)("inlineCode",{parentName:"p"},"GlobalNoUTurnSampler")," has all the acceptance step size, covariance matrix and acceptance probability tuning arguments of ",(0,t.mdx)("inlineCode",{parentName:"p"},"GlobalHamiltonianMonteCarlo")," as well as a few more related to tuning the path length. We set the maximum size of the binary tree using ",(0,t.mdx)("inlineCode",{parentName:"p"},"max_tree_depth"),". The ",(0,t.mdx)("inlineCode",{parentName:"p"},"max_delta_energy")," is roughly the lowest probability moves we will consider. This should be interpreted as a negative log probability and is designed to be fairly conservative. The initial step size is set by ",(0,t.mdx)("inlineCode",{parentName:"p"},"initial_step_size")," where this values is simply the step size if tuning is disabled. The argument ",(0,t.mdx)("inlineCode",{parentName:"p"},"multinomial_sampling")," lets us decide between a faster multinomial sampler for the trajectory or the slice sampler in the original paper. The option is useful for fairly comparing against other NUTS implementations. The ",(0,t.mdx)("inlineCode",{parentName:"p"},"target_accept_prob")," argument indicates the acceptance probability which should be targeted by the step size tuning algorithm. While the optimal value is 65.1% higher values have been show to be more robust leading to a default of 0.8."),(0,t.mdx)("p",null,"In practice, the parameters you are most likely to modify are ",(0,t.mdx)("inlineCode",{parentName:"p"},"target_accept_prob")," and ",(0,t.mdx)("inlineCode",{parentName:"p"},"max_tree_depth"),". When dealing with posteriors where the probability density has a more complicated shape, we benefit from taking smaller steps. Setting ",(0,t.mdx)("inlineCode",{parentName:"p"},"target_accept_prob")," to a higher value like ",(0,t.mdx)("inlineCode",{parentName:"p"},"0.9")," will need to a more careful exploration of the space using smaller step sizes while still benefiting from some tuning of that step size. Since we will be taking smaller steps we need to compensate by having a larger path length. This is accomplished by increasing ",(0,t.mdx)("inlineCode",{parentName:"p"},"max_tree_depth"),". Otherwise, using the defaults provided is highly recommended."))}o.isMDXComponent=!0}}]);