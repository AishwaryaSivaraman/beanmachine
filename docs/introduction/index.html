<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Bean Machine RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Bean Machine Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-44373548-47","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.css"><title data-react-helmet="true">Introduction | Bean Machine</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://beanmachine.org/docs/introduction/"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Introduction | Bean Machine"><meta data-react-helmet="true" name="description" content="Bean Machine is a probabilistic programming language that makes developing and deploying generative probabilistic models intuitive and efficient."><meta data-react-helmet="true" property="og:description" content="Bean Machine is a probabilistic programming language that makes developing and deploying generative probabilistic models intuitive and efficient."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://beanmachine.org/docs/introduction/"><link data-react-helmet="true" rel="alternate" href="https://beanmachine.org/docs/introduction/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://beanmachine.org/docs/introduction/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.01a22e7d.css">
<link rel="preload" href="/assets/js/runtime~main.bf38f359.js" as="script">
<link rel="preload" href="/assets/js/main.4d3c482f.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Bean Machine</b></a><a class="navbar__item navbar__link" href="/docs/why_bean_machine/">Docs</a><a class="navbar__item navbar__link" href="/docs/tutorials/">Tutorials</a><a href="/api/index.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>API<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><main class="docMainContainer_r8cw docMainContainerEnhanced_SOUu"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_XoVD"><div class="docItemContainer_6jsP"><article><header><h1 class="docTitle_ft6A">Introduction</h1></header><div class="markdown"><p>Bean Machine is a probabilistic programming language that makes developing and deploying generative probabilistic models intuitive and efficient.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="why-generative-models">Why Generative models?<a aria-hidden="true" class="hash-link" href="#why-generative-models" title="Direct link to heading">â€‹</a></h2><p>Bean Machine&#x27;s generative modeling is concerned not only with providing useful predictions (as traditional ML techniques do), but also with estimating the uncertainty inherent in the problem at hand in the form of probability distributions. Estimating uncertainty helps ensure that predictions are reliable and robust.</p><p>Generative modeling with Bean Machine offers many benefits:</p><ol><li><strong>Uncertainty estimation.</strong>  Predictions are quantified with reliable measures of uncertainty in the form of probability distributions. An analyst can understand not only the system&#x27;s prediction, but also the relative likelihood of other possibilities.</li><li><strong>Expressivity.</strong>  It&#x27;s extremely easy to encode a rich model directly in source code. This allows one to match the structure of the model to the structure of the problem.</li><li><strong>Interpretability.</strong>  Because the model matches the domain, one can query intermediate variables within the model as conceptually meaningful properties. This can be used to interpret <em>why</em> a particular prediction was made, and can aid the model development process.</li></ol><h2 class="anchor anchorWithStickyNavbar_y2LR" id="generative-probabilistic-models">Generative Probabilistic Models<a aria-hidden="true" class="hash-link" href="#generative-probabilistic-models" title="Direct link to heading">â€‹</a></h2><p>A generative probabilistic model consists of <strong>random variables</strong> and <strong>conditional probability distributions</strong> (CPDs) that encode knowledge about some domain. For example, consider a simplified model for the spread of infectious diseases, where we wish to express the idea that the average number of new cases on a given day is proportional to the current number of infections, with the proportionality constant being the daily reproduction rate of the disease. In order to express this mathematically, it is common practice to rely on <em>elementary probability distributions</em> (EPDs) with well known statistics, such as the <em>Poisson</em> distribution here:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">num_new_cases ~ Poisson(reproduction_rate * num_infected)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><img src="/assets/images/poisson_3-efa1b689adff7f22f127cbbc33a787a2.png"></p><p>Let&#x27;s fix for now the value of <code>num_infected</code>, then the above statement gives the CPD of the random variable <code>num_new_cases</code>, conditioned on the value of its <strong>parent</strong> random variable <code>reproduction_rate</code>. Since the parameter of the Poisson distribution is also its mean, this CPD is consistent with the knowledge that we were trying to express.</p><p>A well-formed generative model must specify the EPD or CPD of each random variable, and the <strong>directed graph</strong> induced by all the parent-child relationships among random variables must be <strong>acyclic</strong>. To complete our model, we must therefore also specify a distribution for the random variable <code>reproduction_rate</code>. In the case of new diseases, where we don&#x27;t know anything yet about the actual reproduction rate, this poses a seemingly intractable problem. In the <strong>Bayesian approach</strong> to this problem, we specify the probability distributions of random variables without parents as our <strong><em>a priori</em></strong> beliefs (i.e., before seeing any data) about them. So, in this example, if infectious disease experts believe that a new disease would have a daily reproduction rate which is strictly positive and could be expected to be drawn from a distribution with a mean of 0.1, then we could express this belief with the help of another EPD, the <em>Exponential</em> distribution, as follows:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">reproduction_rate ~ Exponential(1 / 0.1)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><img src="/assets/images/exponential_10-efd1ffd10a5e6115b52868fd955e31fa.png"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="inference">Inference<a aria-hidden="true" class="hash-link" href="#inference" title="Direct link to heading">â€‹</a></h2><p>Given a generative model, the natural next step is to use it to perform inference. Inference is the process of combining a <strong>model</strong> with <strong>data</strong> to obtain <strong>insights</strong>, in the form of <strong><em>a posteriori</em></strong> beliefs over values of interest. Our documentation refers to the data as <em>&quot;observations&quot;</em>, to the values of interest as <em>&quot;queried random variables&quot;</em>, and to the insights as <em>&quot;posterior distributions&quot;</em>.</p><p>In our example above, let&#x27;s say we observe that <code>num_infected = 1087980</code> and that <code>num_new_cases = 238154</code>. Now, given this observation, we might want to query the posterior distribution for <code>reproduction_rate</code>. Mathematically speaking, we seek the following CPD:</p><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">P</mi><mo stretchy="false">(</mo><mtext mathvariant="monospace">reproduction_rate</mtext><mtext>â€‰</mtext><mo>âˆ£</mo><mtext>â€‰</mtext><mtext mathvariant="monospace">num_infected</mtext><mo>=</mo><mn>1087980</mn><mo separator="true">,</mo><mtext>â€…â€Š</mtext><mtext mathvariant="monospace">num_new_cases</mtext><mo>=</mo><mn>238154</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbb{P}(\texttt{reproduction\_rate} \,\mid\, \texttt{num\_infected}=1087980,\; \texttt{num\_new\_cases} = 238154)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathbb">P</span></span><span class="mopen">(</span><span class="mord text"><span class="mord texttt">reproduction_rate</span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">âˆ£</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.70625em;vertical-align:-0.09514em"></span><span class="mord text"><span class="mord texttt">num_infected</span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">8</span><span class="mord">7</span><span class="mord">9</span><span class="mord">8</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord text"><span class="mord texttt">num_new_cases</span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">2</span><span class="mord">3</span><span class="mord">8</span><span class="mord">1</span><span class="mord">5</span><span class="mord">4</span><span class="mclose">)</span></span></span></span></span></p><p>One way to understand the semantics of the inference task is to think of a generative probabilistic model as specifying a distribution over possible <strong>worlds</strong>. A world can be thought of as an assignment of specific admissible values to all random variables in the model. So, for example, some possible worlds in our case are:</p><ul><li><code>reproduction_rate = 0.01, num_new_cases = 9000</code>,</li><li><code>reproduction_rate = 0.1, num_new_cases = 90000</code>, or</li><li><code>reproduction_rate = 0.9, num_new_cases = 800000</code>.</li></ul><p>Our generative model specifies a <em>joint</em> probability distribution over each of these worlds, based on the <em>prior</em> distribution we&#x27;ve chosen for <code>reproduction_rate</code> and the <em>likelihood</em> of <code>num_new_cases</code> given some <code>reproduction_rate</code>. Now, the inference task is to restrict attention to only those worlds in which <code>num_new_cases = 238154</code>. We&#x27;re interested in learning the resulting <em>posterior</em> distribution over <code>reproduction_rate</code> assignments within these worlds that are compatible with our observation.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="target-audience">Target Audience<a aria-hidden="true" class="hash-link" href="#target-audience" title="Direct link to heading">â€‹</a></h2><p>In the rest of this Overview we&#x27;ll introduce you to Bean Machine, and show you how it can be used to learn about problems like this one.</p><p>While we hope that the guides you&#x27;ll find here are relevant to anyone with an ML background, there are excellent resources available if this is your first exposure to Bayesian analysis! We highly recommend the excellent YouTube series <em><a href="https://www.youtube.com/playlist?list=PLDcUM9US4XdNM4Edgs7weiyIguLSToZRI" target="_blank" rel="noopener noreferrer">Statistical Rethinking</a></em>, which walks through Bayesian thinking and probabilistic modeling. For a more hands-on experience, you can check out the free, online tutorial <em><a href="https://camdavidsonpilon.github.io/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers/#contents" target="_blank" rel="noopener noreferrer">Bayesian Methods for Hackers</a></em>.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"></div></div><br><div class="row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/../docs/overview/introduction/introduction.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#why-generative-models" class="table-of-contents__link toc-highlight">Why Generative models?</a></li><li><a href="#generative-probabilistic-models" class="table-of-contents__link toc-highlight">Generative Probabilistic Models</a></li><li><a href="#inference" class="table-of-contents__link toc-highlight">Inference</a></li><li><a href="#target-audience" class="table-of-contents__link toc-highlight">Target Audience</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_SRtH"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></a></div><div class="footer__copyright">Copyright &#169; 2021 Facebook, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.bf38f359.js"></script>
<script src="/assets/js/main.4d3c482f.js"></script>
</body>
</html>