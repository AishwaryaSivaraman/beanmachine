<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Bean Machine Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Bean Machine Blog Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.css"><title data-react-helmet="true">inference | Bean Machine</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://home.fburl.com/ppl/docs/framework_topics/inference/inference"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="inference | Bean Machine"><meta data-react-helmet="true" name="description" content="Posterior distributions can often only be estimated, as the solution such problems in general have no closed-form. Bean Machine&#x27;s inference methods typically use sequential sampling techniques known as Markov chain Monte Carlo (MCMC) to generate samples representative of this distribution. These posterior samples are the main output of Bean Machine: with enough samples, they will reliably resemble the posterior distribution for the problem at hand."><meta data-react-helmet="true" property="og:description" content="Posterior distributions can often only be estimated, as the solution such problems in general have no closed-form. Bean Machine&#x27;s inference methods typically use sequential sampling techniques known as Markov chain Monte Carlo (MCMC) to generate samples representative of this distribution. These posterior samples are the main output of Bean Machine: with enough samples, they will reliably resemble the posterior distribution for the problem at hand."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://home.fburl.com/ppl/docs/framework_topics/inference/inference"><link data-react-helmet="true" rel="alternate" href="https://home.fburl.com/ppl/docs/framework_topics/inference/inference" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://home.fburl.com/ppl/docs/framework_topics/inference/inference" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.d66fe993.css">
<link rel="preload" href="/assets/js/runtime~main.4838cf28.js" as="script">
<link rel="preload" href="/assets/js/main.7a957c42.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Bean Machine</b></a><a class="navbar__item navbar__link" href="/docs/toc">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><main class="docMainContainer_3ufF docMainContainerEnhanced_3NYZ"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>inference</h1></header><header><h1>Inference</h1></header><p>Posterior distributions can often only be estimated, as the solution such problems in general have no closed-form. Bean Machine&#x27;s inference methods typically use sequential sampling techniques known as <a href="https://towardsdatascience.com/a-zero-math-introduction-to-markov-chain-monte-carlo-methods-dcba889e0c50" target="_blank" rel="noopener noreferrer">Markov chain Monte Carlo (MCMC)</a> to generate samples representative of this distribution. These posterior samples are the main output of Bean Machine: with enough samples, they will reliably resemble the posterior distribution for the problem at hand.</p><p>To support inference algorithms, Bean Machine represents the model as a directed acyclic graph where each node is a random variable and edges between nodes represent dependencies between random variables. During a single iteration of inference, Bean Machine assigns a specific, concrete value to each of the unobserved random variable functions in your model. We refer to this assignment as one &quot;world&quot; in Bean Machine.</p><p>Each world corresponds to a potential sample for the posterior distribution. Bean Machine evaluates how well a particular world would explain the observed data (and prior beliefs). Bean Machine will tend to retain worlds that explain the observed data well and add them as samples to the computed posterior distribution. Bean Machine will tend to discard worlds that do a poor job of explaining the observed data.</p><p>As a part of MCMC inference, worlds are computed sequentially. A new world is &quot;proposed&quot; based on the random variable assignments from the current world. In each inference step, Bean Machine iterates over all unobserved random variables and proposes a new value. The world is updated to reflect this change; that is, likelihoods are updated and new variables may be added or removed. This updated world will either replace the existing world or be discarded as determined by the specific inference method. The value associated with each variable at the <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em"></span><span class="mord mathnormal">i</span></span></span></span></span>th inference step is returned as the <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em"></span><span class="mord mathnormal">i</span></span></span></span></span>th sample for the variable.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="inference-methods"></a>Inference methods<a class="hash-link" href="#inference-methods" title="Direct link to heading">#</a></h2><p>As you can tell, there are a variety of ways of proposing new worlds from the current world, and even for deciding whether to accept or reject a proposed world! This process is collectively referred to as an inference method. Lots of research goes into designing inference methods that are both flexible and performant for a wide class of models. Bean Machine supports many inference methods out-of-the-box. Check out the docs under <strong>Inference methods</strong> to learn more!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="programmable-inference"></a>Programmable inference<a class="hash-link" href="#programmable-inference" title="Direct link to heading">#</a></h2><p>One of the key innovations in Bean Machine is the idea that inference is programmable. Bean Machine&#x27;s single-site paradigm allows you to modularly mix-and-match inference components to get the most out of your model.</p><p>Compositional inference allows you to utilize distinct inference methods for different random variables when fitting a model. Our flexible transformations framework allows you to leverage domain-specific transformations or proposers, which can be especially powerful to avoid worse edge-case performance when running inference over constrained random variables. Block inference allows you to propose updates for several random variables jointly, which can be necessary when dealing with highly-correlated variables. All of these techniques are covered in the <strong>Programmable inference</strong> section.</p><p>We&#x27;ve also included a section on Bean Machine&#x27;s framework for implementing and manipulating <strong>Custom proposers</strong>. This framework exposes tools for building domain-specific proposers which can be plugged in modularly with many of Bean Machine&#x27;s existing inference methods.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/../docs/framework_topics/inference/inference.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#inference-methods" class="table-of-contents__link">Inference methods</a></li><li><a href="#programmable-inference" class="table-of-contents__link">Programmable inference</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_MyFc"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div><div class="footer__copyright">Copyright &#169; 2021 Facebook, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.4838cf28.js"></script>
<script src="/assets/js/main.7a957c42.js"></script>
</body>
</html>