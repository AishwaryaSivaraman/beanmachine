<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Bean Machine Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Bean Machine Blog Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.css"><title data-react-helmet="true">Introduction | Bean Machine</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://home.fburl.com/ppl/docs/overview/introduction/introduction"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Introduction | Bean Machine"><meta data-react-helmet="true" name="description" content="Bean Machine is a probabilistic programming language (PPL) that makes developing and deploying generative probabilistic models intuitive and efficient."><meta data-react-helmet="true" property="og:description" content="Bean Machine is a probabilistic programming language (PPL) that makes developing and deploying generative probabilistic models intuitive and efficient."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://home.fburl.com/ppl/docs/overview/introduction/introduction"><link data-react-helmet="true" rel="alternate" href="https://home.fburl.com/ppl/docs/overview/introduction/introduction" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://home.fburl.com/ppl/docs/overview/introduction/introduction" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.d66fe993.css">
<link rel="preload" href="/assets/js/runtime~main.aeb25d8e.js" as="script">
<link rel="preload" href="/assets/js/main.7a957c42.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Bean Machine</b></a><a class="navbar__item navbar__link" href="/docs/toc">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Documentation</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/toc">TOC</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/overview/introduction/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview/quick_start/quick_start">Quick Start</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview/modeling/modeling">Modeling</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview/inference/inference">Inference</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview/analysis/analysis">Analysis</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/contributing">Contributing</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Introduction</h1></header><p>Bean Machine is a probabilistic programming language (PPL) that makes developing and deploying generative probabilistic models intuitive and efficient.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="why-generative-models"></a>Why generative models?<a class="hash-link" href="#why-generative-models" title="Direct link to heading">#</a></h2><p>Bean Machine&#x27;s generative modeling is concerned not only with providing useful predictions (as traditional ML techniques do), but also with estimating the uncertainty inherent in the problem at hand in the form of probability distributions. Estimating uncertainty helps ensure that predictions are reliable and robust.</p><p>Generative modeling with Bean Machine offers many benefits:</p><ol><li><strong>Uncertainty estimation.</strong>  Predictions are quantified with reliable measures of uncertainty in the form of probability distributions. An analyst can understand not only the system&#x27;s prediction, but also the relative likelihood of other possibilities.</li><li><strong>Expressivity.</strong>  It&#x27;s extremely easy to encode a rich model directly in source code. This allows one to match the structure of the model to the structure of the problem.</li><li><strong>Interpretability.</strong>  Because the model matches the domain, one can query intermediate learned properties within the model. This can be used to interpret <em>why</em> a particular prediction was made, and can aid the model development process.</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="generative-probabilistic-models"></a>Generative probabilistic models<a class="hash-link" href="#generative-probabilistic-models" title="Direct link to heading">#</a></h2><p>A generative probabilistic model consists of <strong>random variables</strong> and <strong>conditional probability distributions</strong> (CPD) that encode knowledge about some domain. For example, consider a simplified model for the spread of infectious diseases where we wish to express the fact that the number of new cases on a given day is on average the current number of infected persons times the daily reproduction rate of the disease. In order to mathematically state this probabilistic fact, it is a common practice to rely on <em>elementary probability distributions</em> (EPD) with well known statistics such as <em>Poisson</em> as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">num_new_cases ~ Poisson(reproduction_rate * num_infected)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><img src="/assets/images/poisson_3-efa1b689adff7f22f127cbbc33a787a2.png"></p><p>Let&#x27;s assume that <code>num_infected</code> is a constant, then the above statement gives the CPD of the random variable <code>num_new_cases</code> conditioned on the value of its <strong>parent random variable</strong>, <code>reproduction_rate</code>.
Since the parameter of the Poisson distribution is also its mean, this CPD is consistent with the knowledge that we were trying to express.</p><p>A well-formed generative model must specify the CPD of each random variable and the graph induced by the parent-child relationship between random variables must be acyclic. To complete this model, we must therefore specify the CPD of the random variable <code>reproduction_rate</code>. In the case of new diseases where we don&#x27;t know anything about the actual reproduction rate, this poses a seemingly intractable problem. The <strong>Bayesian approach</strong> suggests a solution to this problem. In this approach, we specify our <em>a-priori</em> belief (i.e. our belief before seeing any data) about the distribution of random variables as their CPD. So, in this example, if infectious disease experts believe that a new disease would have a daily reproduction rate drawn from a distribution with a mean of 0.1, we could express this belief with the help of another EPD, the <em>Exponential</em> distribution, as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">reproduction_rate ~ Exponential(1 / 0.1)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><img src="/assets/images/exponential_10-efd1ffd10a5e6115b52868fd955e31fa.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="inference"></a>Inference<a class="hash-link" href="#inference" title="Direct link to heading">#</a></h2><p>Given a generative model, the natural next step is to use it to perform inference. Inference is the process of combining a <em>model</em> with <em>data</em> to obtain <em>insights</em>, in the form of probability distributions over values of interest. Our documentation refers to the data as &quot;observations&quot;, the insights as &quot;posterior distributions&quot;, and the values of interest as &quot;queried random variables&quot;.</p><p>In our example above, let&#x27;s say we observe that <code>num_infected</code> is 1087980 and that <code>num_new_cases</code> is 238154. Now, given this observation, we might want to query the posterior distribution for <code>reproduction_rate</code>. Or, mathematically speaking, we seek the following,</p><p>[
\mathbb{P}(\texttt{reproduction_rate} \mid \texttt{num_new_cases} = 238154, \texttt{num_infected}=1087980)
]</p><p>One way to understand the semantics of the inference task is to think of a generative probabilistic model as specifying a distribution over possible <strong>worlds</strong>. A world can be thought of as an assignment of values to all random variables in the model. So, for example, some possible worlds are:</p><ul><li><code>reproduction_rate</code> = 0.01, <code>num_new_cases</code> = 9000,</li><li><code>reproduction_rate</code> = 0.1, <code>num_new_cases</code> = 90000, or</li><li><code>reproduction_rate</code> = 0.9, <code>num_new_cases</code> = 800000.</li></ul><p>Our generative model specifies a probability distribution over each of these worlds. Now, the inference task is to restrict attention to only worlds where <code>num_new_cases</code> = 238154. We&#x27;re interested in learning <code>reproduction_rate</code> within these worlds.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="where-does-bean-machine-fit-in"></a>Where does Bean Machine fit in?<a class="hash-link" href="#where-does-bean-machine-fit-in" title="Direct link to heading">#</a></h2><p>In the coming pages, we&#x27;ll introduce you to Bean Machine syntax, and show how it can be used to learn about problems like this one. Traditionally, lots of painstaking, hand-crafted work has gone into modeling generative scenarios. Bean Machine aims to handle all of the manual work involved in fitting data to your model, leaving you to focus on the exciting part: the problem itself! Keep on reading to find out how.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="target-audience"></a>Target audience<a class="hash-link" href="#target-audience" title="Direct link to heading">#</a></h2><p>While we hope that the guides you&#x27;ll find here are relevant to anyone with an ML background, there are excellent resources available if this is your first exposure to Bayesian analysis! We highly recommend the excellent YouTube series <em><a href="https://www.youtube.com/playlist?list=PLDcUM9US4XdNM4Edgs7weiyIguLSToZRI" target="_blank" rel="noopener noreferrer">Statistical Rethinking</a></em>, which walks through Bayesian thinking and probabilistic modeling. For a more hands-on experience, you can check out the free, online tutorial <em><a href="https://camdavidsonpilon.github.io/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers/#contents" target="_blank" rel="noopener noreferrer">Bayesian Methods for Hackers</a></em>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/../docs/overview/introduction/introduction.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/toc"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« TOC</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/overview/quick_start/quick_start"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Quick Start Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#why-generative-models" class="table-of-contents__link">Why generative models?</a></li><li><a href="#generative-probabilistic-models" class="table-of-contents__link">Generative probabilistic models</a></li><li><a href="#inference" class="table-of-contents__link">Inference</a></li><li><a href="#where-does-bean-machine-fit-in" class="table-of-contents__link">Where does Bean Machine fit in?</a></li><li><a href="#target-audience" class="table-of-contents__link">Target audience</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_MyFc"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div><div class="footer__copyright">Copyright &#169; 2021 Facebook, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.aeb25d8e.js"></script>
<script src="/assets/js/main.7a957c42.js"></script>
</body>
</html>