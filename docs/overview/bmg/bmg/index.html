<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Bean Machine RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Bean Machine Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.css"><title data-react-helmet="true">The Bean Machine Graph (BMG) C++ Runtime | Bean Machine</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://beanmachine.org/docs/overview/bmg/bmg"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="The Bean Machine Graph (BMG) C++ Runtime | Bean Machine"><meta data-react-helmet="true" name="description" content="Bean Machine Graph (BMG) is an experimental C++ inference engine optimized for MCMC inference on static graphical models (i.e., models whose dependency structure is independent of all random variablesâ€™ values). Whereas Bean Machine models are defined through a series of random variables and functionals, Bean Machine Graph models are defined through the explicit construction of their computation graphs. Bean Machine Graph then performs inference directly on this graphical representation of the model."><meta data-react-helmet="true" property="og:description" content="Bean Machine Graph (BMG) is an experimental C++ inference engine optimized for MCMC inference on static graphical models (i.e., models whose dependency structure is independent of all random variablesâ€™ values). Whereas Bean Machine models are defined through a series of random variables and functionals, Bean Machine Graph models are defined through the explicit construction of their computation graphs. Bean Machine Graph then performs inference directly on this graphical representation of the model."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://beanmachine.org/docs/overview/bmg/bmg"><link data-react-helmet="true" rel="alternate" href="https://beanmachine.org/docs/overview/bmg/bmg" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://beanmachine.org/docs/overview/bmg/bmg" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.f0688ba9.css">
<link rel="preload" href="/assets/js/runtime~main.fa1e391f.js" as="script">
<link rel="preload" href="/assets/js/main.93aa2791.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Bean Machine</b></a><a class="navbar__item navbar__link" href="/docs/toc">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Framework</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Advanced</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/overview/bmg/bmg">C++ Runtime</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview/beanstalk/beanstalk">Compiler</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Tutorials</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">API</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Packages</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Contributing</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Sitemap (formerly TOC)</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_XoVD"><div class="docItemContainer_6jsP"><article><header><h1 class="docTitle_ft6A">The Bean Machine Graph (BMG) C++ Runtime</h1></header><div class="markdown"><p>Bean Machine Graph (BMG) is an experimental C++ inference engine optimized for MCMC inference on static graphical models (i.e., models whose dependency structure is independent of all random variablesâ€™ values). Whereas Bean Machine models are defined through a series of random variables and functionals, Bean Machine Graph models are defined through the explicit construction of their computation graphs. Bean Machine Graph then performs inference directly on this graphical representation of the model.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="modeling">Modeling<a aria-hidden="true" class="hash-link" href="#modeling" title="Direct link to heading">â€‹</a></h2><p>Bean Machine Graph currently supports models with static graphs, as the full computation graph for the model must be explicitly defined at compile-time. The graphical representation of a model consists of a collection of nodes representing distributions, samples, constants, operators, and so on. For example, consider the following model:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">@random_variable</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def a():</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return Normal(0, 1.)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@random_variable</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def b():</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return Normal(a() + 5, 1.)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>In Bean Machine Graph, we represent it with the following graph:
<img alt="Typical DOT rendering of graph for model above" src="/assets/images/image-dbb3a3a615eddfd4d377ee696ba54155.png"></p><p>Though Bean Machine Graph supports many commonly-used distributions and operators, it is less expressive than Bean Machine Python, which supports dynamic models, rich programmable inference, and so on.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="inference">Inference<a aria-hidden="true" class="hash-link" href="#inference" title="Direct link to heading">â€‹</a></h2><p>Bean Machine Graph currently supports Newtonian Monte Carlo, Gibbs sampling for Boolean variables, as well as rejection sampling. It performs inference efficiently by taking advantage of the static nature of its models. It also uses its own MCMC-focused automatic differentiation (AD) engine and performs the necessary gradient computations faster than other general-purpose AD engines which often have additional overhead.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="using-bean-machine-graph">Using Bean Machine Graph<a aria-hidden="true" class="hash-link" href="#using-bean-machine-graph" title="Direct link to heading">â€‹</a></h2><p>Due to the complexity of constructing the computation graph directly, users interested in Bean Machine Graph should use the <a href="/docs/overview/beanstalk/beanstalk">Beanstalk</a> compiler, which enables users to write models using Bean Machine Python syntax and call the Bean Machine Graph inference engine as if it were another Bean Machine inference method.
To learn more about the current state of inference in Bean Machine Graph and experiment with different models, see the <a href="/docs/overview/beanstalk/beanstalk">Beanstalk documentation</a>.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"></div></div><br><div class="row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/../docs/overview/bmg/bmg.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/framework_topics/programmable_inference/transforms"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->transforms</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/overview/beanstalk/beanstalk"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Compiler<!-- --> Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#modeling" class="table-of-contents__link toc-highlight">Modeling</a></li><li><a href="#inference" class="table-of-contents__link toc-highlight">Inference</a></li><li><a href="#using-bean-machine-graph" class="table-of-contents__link toc-highlight">Using Bean Machine Graph</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_SRtH"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></a></div><div class="footer__copyright">Copyright &#169; 2021 Facebook, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.fa1e391f.js"></script>
<script src="/assets/js/main.93aa2791.js"></script>
</body>
</html>