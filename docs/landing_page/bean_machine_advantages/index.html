<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Bean Machine RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Bean Machine Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-44373548-47","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.css"><title data-react-helmet="true">Bean Machine Advantages | Bean Machine</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://beanmachine.org/docs/landing_page/bean_machine_advantages"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Bean Machine Advantages | Bean Machine"><meta data-react-helmet="true" name="description" content="By building on top of PyTorch and providing declarative syntax, Bean Machine can be simultaneously performant and intuitive. Bean Machine provides further value by implementing cutting-edge inference algorithms and allowing the user to select and program custom inferences for different problems and subproblems."><meta data-react-helmet="true" property="og:description" content="By building on top of PyTorch and providing declarative syntax, Bean Machine can be simultaneously performant and intuitive. Bean Machine provides further value by implementing cutting-edge inference algorithms and allowing the user to select and program custom inferences for different problems and subproblems."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://beanmachine.org/docs/landing_page/bean_machine_advantages"><link data-react-helmet="true" rel="alternate" href="https://beanmachine.org/docs/landing_page/bean_machine_advantages" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://beanmachine.org/docs/landing_page/bean_machine_advantages" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.dd72c71e.css">
<link rel="preload" href="/assets/js/runtime~main.84e77390.js" as="script">
<link rel="preload" href="/assets/js/main.8cb5e13d.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Bean Machine</b></a><a class="navbar__item navbar__link" href="/docs/introduction">Docs</a><a class="navbar__item navbar__link" href="/docs/tutorials">Tutorials</a><a href="/api/index.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>API<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><main class="docMainContainer_r8cw docMainContainerEnhanced_SOUu"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_XoVD"><div class="docItemContainer_6jsP"><article><header><h1 class="docTitle_ft6A">Bean Machine Advantages</h1></header><div class="markdown"><p>By building on top of PyTorch and providing declarative syntax, Bean Machine can be simultaneously performant and intuitive. Bean Machine provides further value by implementing cutting-edge inference algorithms and allowing the user to select and program custom inferences for different problems and subproblems.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="single-site-inference">Single-Site Inference<a aria-hidden="true" class="hash-link" href="#single-site-inference" title="Direct link to heading">â€‹</a></h2><p>Bean Machine&#x27;s inference engine uses <em>single-site inference</em>. In the single-site paradigm, models are built up from <em>random variables</em> that can be reasoned about individually. This creates a more intuitive user experience, allows for optimizations that can&#x27;t be achieved in other systems and enables the advanced techniques outlined below.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="declarative-modeling">Declarative modeling<a aria-hidden="true" class="hash-link" href="#declarative-modeling" title="Direct link to heading">â€‹</a></h2><p>In Bean Machine, random variables are implemented as decorated Python functions, which naturally form an interface to the model. Using functions makes it simple to determine a random variable&#x27;s definition, since it is contained in a function that is usually only a few lines long. This lets you directly refer to random variables to access inferred distributions or when binding data to your model; this is safer and more natural than relying on string identifiers.</p><p>Declarative modeling also frees the inference engine to reorder model execution. Foremost, it enables computation of immediate dependencies for random variables. This makes it possible to propose new values for a random variable by examining only its dependencies, saving significant amounts of compute in models with complex structure. Because the language recognizes random variables as a special value, it can accept or reject proposals for each random variable sequentially. Compared to global inference, this single-site paradigm can drastically improve convergence rates, since a single bad proposal will affect only a single random variable.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="programmable-inference">Programmable inference<a aria-hidden="true" class="hash-link" href="#programmable-inference" title="Direct link to heading">â€‹</a></h2><p>Bean Machine allows the user to design and apply new and powerful inference methods. Because Bean Machine can propose updates for random variables individually, the user is free to customize the <em>method</em> which it uses to propose those values. Different inference methods can be supplied for different families of random variables. For example, a particular model can leverage gradient information when proposing values for differentiable random variables, and at the same time might sample from discrete ones with a particle filter. The single-site paradigm enables seamless interoperation among any MCMC-based inference strategies.</p><p>Programmable inference extends beyond just the inference customization. MCMC inference methods in Bean Machine are comprised of two main components: the <em>inference method</em>, and any <em>proposers</em> it may use. Though Bean Machine comes with a rich set of unconstrained proposers,  it is useful to use constrained proposers for constrained spaces. This can improve performance at boundaries of constrained spaces, where transformations into unconstrained spaces can introduce substantial warping.</p><p>Lastly, single-site inference is not always the right tool tool for the job. In cases when random variables are strongly correlated, Bean Machine offers tools such as block inference to jointly propose new values simultaneously.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="advanced-methods">Advanced methods<a aria-hidden="true" class="hash-link" href="#advanced-methods" title="Direct link to heading">â€‹</a></h2><p>Bean Machine supports a variety of classic inference methods such as ancestral sampling and the No U-Turn sampler (NUTS). However, the framework leverages single-site understanding of the model in order to provide efficient methods that take advantage of higher-order gradients and model structure.</p><p>Bean Machine includes the first implementation of Newtonian Monte Carlo (NMC) in a more general platform. NMC utilizes second-order gradient information to construct a multivariate Gaussian proposer that takes local curvature into account. As such, it can produce sample very efficiently with no warmup period when the posterior is roughly Gaussian. Bean Machine&#x27;s structural understanding of the model lets us keep computation relatively cheap by only modeling a subset of the space that is relevant to updating a particular random variable.</p><p>Using programmable inference, Bean Machine itself implements numerous enhancements to core inference algorithms. Dynamic learning algorithms enable us to continuously and automatically evolve inference strategies to better model the problem at hand, without paying the hefty cost of a warmup period. A &quot;mixture of proposers&quot; technique lets us blend the benefits of using proposers that precisely describe local curvature, along with less precise ones to enable whole-space generalization. All of these approaches are built upon a highly modular inference framework, enabling you to mix-and-match methods -- or even invent new ones -- with ease.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"></div></div><br><div class="row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/../docs/landing_page/bean_machine_advantages.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#single-site-inference" class="table-of-contents__link toc-highlight">Single-Site Inference</a></li><li><a href="#declarative-modeling" class="table-of-contents__link toc-highlight">Declarative modeling</a></li><li><a href="#programmable-inference" class="table-of-contents__link toc-highlight">Programmable inference</a></li><li><a href="#advanced-methods" class="table-of-contents__link toc-highlight">Advanced methods</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_SRtH"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></a></div><div class="footer__copyright">Copyright &#169; 2021 Facebook, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.84e77390.js"></script>
<script src="/assets/js/main.8cb5e13d.js"></script>
</body>
</html>