---
title: Coin flipping
sidebar_label: Coin flipping
path: overview/tutorials/Coin_flipping/CoinFlipping
nb_path: tutorials/Coin_flipping.ipynb
github: https://github.com/facebookresearch/beanmachine/blob/main/tutorials/Coin_flipping.ipynb
colab: https://colab.research.google.com/github/facebookresearch/beanmachine/blob/main/tutorials/Coin_flipping.ipynb
---
import { PlotlyFigure6f95b253b12b4ed68a6c1943a4cee38e } from "./CoinFlipping.jsx";
import CellOutput from "../../../../website/src/components/CellOutput.jsx";
import { PlotlyFigure8ee86c3839b54b939c0fd87c4e81c7ef } from "./CoinFlipping.jsx";
import LinkButtons from "../../../../website/src/components/LinkButtons.jsx";

<LinkButtons
  githubUrl="https://github.com/facebookresearch/beanmachine/blob/main/tutorials/Coin_flipping.ipynb"
  colabUrl="https://colab.research.google.com/github/facebookresearch/beanmachine/blob/main/tutorials/Coin_flipping.ipynb"
/>

## Tutorial: Estimating heads rate of a coin


This tutorial demonstrates modeling and running inference on a simple coin-flipping
model in Bean Machine. This should offer an accessible introduction to fundamental
features of Bean Machine.


## Problem


In this tutorial we consider the problem of estimating the probability of heads for a
potentially biased coin. In this setup, we have flipped the coin a few times and
recorded the results as training data. We're interested in learning about the coin's
true heads rate.


## Prerequisites


Let's code this in Bean Machine! Import the Bean Machine library and some fundamental
PyTorch classes.


```python
import os
import sys

if "google.colab" in sys.modules and "beanmachine" not in sys.modules:
    !pip install beanmachine

import beanmachine.ppl as bm
import beanmachine.ppl.inference.monte_carlo_samples
import matplotlib.pyplot as plt
import pandas as pd
import torch
import torch.distributions as dist
from torch import tensor
from IPython.display import Markdown


plt.rc("figure", figsize=[8, 6])
plt.rc("font", size=14)
plt.rc("lines", linewidth=2.5)
pd.set_option("precision", 3)
bm.seed(11)
# for CI testing
smoke_test = "SANDCASTLE_NEXUS" in os.environ or "CI" in os.environ
```

## Model


We have the following definitions.

* $\theta \in [0, 1]$: Heads rate of the coin.
* $y_i \in \{0, 1\}$: Result of the $i$th coin flip. This is usually an observed value.
* $N \in \mathbb{Z}^+$: Number of observed coin flips.

We're interested in modeling:

* $\mathbb{P}(\theta | \{y_i\}_{i=1}^N)$

Solving this problem requires specifying a prior distribution for $\theta$ and the
relationship between thee unobserved random variable $\theta$, and the observed random
variables $\{y_i\}_{i=1}^N$. We can do this as follows:

* $\theta \sim \text{Beta}(2, 2)$
* $y_i \stackrel{iid}{\sim} \text{Bernoulli}(\theta)$

As a convention, we will consider an outcome of 1 from the Bernoulli distribution to
represent heads and zero to represent tails. Here we chose to use a Beta distribution
for the prior distribution for the coin's probability of heads, but in principle any
distribution over $[0, 1]$ can be used.

Let's visualize the particular Beta distribution used in this tutorial:


```python
thetas = torch.arange(0, 1, 0.01)
plt.plot(thetas, dist.Beta(2, 2).log_prob(thetas).exp())
plt.xlabel(r"$\theta$")
plt.ylabel(r"$\mathbb{P}(\theta)$");
```

![](data:image/png;base64,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
)

We can implement this model in Bean Machine by defining random variable objects with the
`@bm.random_variable` decorator. These functions behave differently than ordinary Python
functions.

<div
  style={
    {
      background: "#daeaf3",
      border_left: "3px solid #2980b9",
      display: "block",
      margin: "16px 0",
      padding: "12px",
    }
  }
>
  Semantics for <code>@bm.random_variable</code> functions:
  <ul>
    <li>
      They must return PyTorch <code>Distribution</code> objects.
    </li>
    <li>
      Though they return distributions, callees actually receive a <i>sample</i> from
      the distribution. The machinery for obtaining samples from distributions is
      handled internally by Bean Machine.
    </li>
    <li>
      Inference runs the model through many iterations. During a particular inference
      iteration, a distinct random variable will correspond to exactly one sampled
      value: <b>calls to the same random variable function with the same arguments will
      receive the same sampled value within one inference iteration</b>. This makes it
      easy for multiple components of your model to refer to the same logical random
      variable.
    </li>
    <li>
      Consequently, to define distinct random variables that correspond to different
      sampled values during a particular inference iteration, an effective practice is
      to add a dummy "indexing" parameter to the function. Distinct random variables can
      be referred to with different values for this index.
    </li>
      <li>
        Please see the documentation for more information about this decorator.
      </li>
  </ul>

  Semantics for <code>@bm.random_variable</code> functions:
  <ul>
    <li>
      This is a decorator that let's you treat deterministic code as if it's a Bean
      Machine random variable. This is used to transform the results of one or more
      random variables.
    </li>
    <li>
      This follows the same naming practice as <code>@bm.random_variable</code> where
      variables are distinguished by their argument call values.
    </li>
  </ul>
</div>

First, let's define our prior for the heads rate, $\theta$, using this syntax:


```python
@bm.random_variable
def theta():
    return dist.Beta(2, 2)
```

Similarly, let's define a random variables for the observed values, $y_i$:


```python
@bm.random_variable
def y(i: int):
    return dist.Bernoulli(theta())
```

The mathematical definitions map directly to the Python definitions.

In contrast to `theta()`, notice that `y(i)` defines a dummy indexing parameter `i`.
That's because `y(i)` is actually defining a _family_ of random variables -- one for
each observed coin flip! This allows us to refer to specific observations as `y(0)`,
`y(1)`, and so on.

In the above examples, we've defined our random variable functions in the toplevel for
convenience. It's worth noting that Bean Machine models can be packaged into Python
classes and instantiated as needed. This essentially namespaces random variables defined
within, since the `self` argument that each random variable receives will be associated
with the distinct instantiated class that it's a part of. Example code is included as an
illustration below; however, this tutorial will continue to use the toplevel
definitions.


```python
class HeadsRateModel(object):
    @bm.random_variable
    def theta(self):
        return dist.Beta(2, 2)

    @bm.random_variable
    def y(self, i):
        return dist.Bernoulli(self.theta())


heads_rate_model = HeadsRateModel()
```

## Data


With the model defined, we need to collect some observed data in order to learn about
values of interest in our model.

In this case, we will observe a few coin flips. For demonstrative purposes, we will use
a synthetically generated dataset of observed values. In practice, you would flip a real
coin and record observations instead.

For our synthetic dataset, we will assume a true heads rate of $0.75$:


```python
true_theta = 0.75
true_y = dist.Bernoulli(true_theta)
```

Now, we'll gather $10$ observations from flipping that coin.


```python
N = 10
y_obs = true_y.sample((N,))
```

```python
y_obs[0]
```

<CellOutput>
{`tensor(1.)`}
</CellOutput>

Let's analyze the dataset:


```python
plt.hist(y_obs.numpy(), bins=2)
plt.xticks([0.25, 0.75], ["Tails", "Heads"])
plt.title(f"Empirical heads rate: {y_obs.mean() :.2f}");
```

![](data:image/png;base64,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
)

## Inference


Inference is the process of combining _model_ and _data_ to obtain _insights_, in the
form of probability distributions over values of interest. Bean Machine offers a
powerful and general inference framework to enable fitting a arbitrary models to data.

Our inference algorithms expect observations in the form of a dictionary. This
dictionary should consist of `@bm.random_variable` invocations as keys, and tensor data
as values. You can see this in the example below:


```python
observations = {
    y(0): y_obs[0],
    y(1): y_obs[1],
    y(2): y_obs[2],
    y(3): y_obs[3],
    y(4): y_obs[4],
    y(5): y_obs[5],
    y(6): y_obs[6],
    y(7): y_obs[7],
    y(8): y_obs[8],
    y(9): y_obs[9],
}
```

Now, we're ready to run inference! For this very simple tutorial, we'll use the simple
Metropolis-Hastings inference algorithm. Check out the documentation or other tutorials
for more advanced examples!

Running inference consists of a few arguments:

| Name           | Usage                                                                                                    |
| -------------- | -------------------------------------------------------------------------------------------------------- |
| `queries`      | List of `@bm.random_variable` targets to fit posterior distributions for.                                |
| `observations` | A dictionary of observations.                                                                            |
| `num_samples`  | Number of Monte Carlo samples to approximate the posterior distributions for the variables in queries.   |
| `num_chains`   | Number of separate inference runs to use. Multiple chains can help verify that inference ran correctly.  |

Let's run inference:


```python
num_samples = 2 if smoke_test else 1000

samples = bm.SingleSiteAncestralMetropolisHastings().infer(
    queries=[theta()],
    observations=observations,
    num_samples=num_samples,
    num_chains=4,
)
```

## Analysis


`samples` now contains our inference results. Although we ran inference only to compute
distributions for `theta()`, in general you can compute distributions for many variables
at once. So, you have to index into this object using the random variable syntax we've
seen several times. Here's an example:


```python
theta_for_four_chains = samples[theta()].detach()
theta_for_four_chains
```

<CellOutput>
{`tensor([[0.7710, 0.7710, 0.7710,  ..., 0.8267, 0.8267, 0.8086],
        [0.2854, 0.2854, 0.7474,  ..., 0.7243, 0.7243, 0.7865],
        [0.8248, 0.7088, 0.7088,  ..., 0.7886, 0.7886, 0.7886],
        [0.6676, 0.7408, 0.6948,  ..., 0.7648, 0.7648, 0.7648]])`}
</CellOutput>

Results from all four separate inference runs are stored in here. We'll use them later;
for now, let's just examine one of these runs:


```python
theta_for_first_chain = theta_for_four_chains[0]
plt.hist(theta_for_first_chain.numpy())
plt.axvline(true_theta, color="red", label=f"True theta = {true_theta :.03f}")
plt.axvline(
    y_obs.mean(),
    color="lightgreen",
    label=f"Empirical heads rate = {y_obs.mean() :.03f}",
)
plt.axvline(
    theta_for_first_chain.mean(),
    color="lightblue",
    label=f"Posterior mean = {theta_for_first_chain.mean() :.03f}",
)
plt.legend();
```

![](data:image/png;base64,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4sVERkamOx/imWeecf9cr149SpYsSY8ePXj55Ze56aabslyH7r4oIvnFeQHvwWHywhQYGJjqfbFixdIdK46Pj0/1PjExkccff5zhw4enqy80NDTHbUgbZMYY9zH4xMREjDHs2LEjXbm0Jwmm1aVLF0JDQ5k3bx6hoaEUL16c2rVrZ3lWeV6H6ENCQtLtLSdvrGS1559s1apVxMXF8fjjj1+zbPJIw/79+7npppsICQnhyy+/TFXm9OnTJCQkZGvdIiK54byAd6hy5cpx4cIFfv/9d0qWLAnA7jTnGjRq1Ig9e/ZQo0aNbNebfJw4p0/ia9iwIdZaTpw4kekx5IzqPnPmDPv27eP11193L/f1119z9erVLNeX1yH6Zs2aMWrUKC5duoSfnx8A0dHRVKpUifDw8CzrBdfwfKtWrYiIiLhm2eTvpWLFiu51T548maNHj7oPE0RHR+Pr60vjxo2vWZ+ISG7oLPoi4o477iAwMJAxY8awf/9+3nvvPebMmZOqzKhRo9i+fTsDBw7km2++Yf/+/axevTrLPd+wsDCMMXz00UecOnWKc+fOZas9ERER9O7dm8jISFauXMmBAwfYuXMnUVFRvP/++5nWXaZMGYKDg1mwYAH79+9nw4YNDBw4kOLFs97WDAoKokaNGlm+shrC79WrFwEBAURGRvL999/z/vvvM3XqVJ555hn3MPn27du59dZb2b59e6plDx8+zKeffkr//v3T1bt161ZeffVVdu/ezcGDB3n33Xd58sknue+++9znJnTo0IE6derQt29fvvnmG9auXcvIkSPp37+/e2NNRMTTFPBFRNmyZXnnnXeIjo7mtttuY/78+bz00kupytSrV4+NGzcSGxtLq1atqF+/PmPGjMlyzzY0NJSJEycybtw4KlSokKO717311ls88sgjPPfcc9x6663ce++9bNy4kbCwsEzrLlasGCtWrODbb7+lbt26DB48mJdeeglfX9/cfTDZVKpUKaKjozl+/DhNmjRh8ODBPPvss6mOn1+4cIEffviBCxcupFp20aJFlCpVKt3JgQC+vr6sWLGC1q1bU7t2bV544QX69+/PsmXL3GW8vLz46KOPCAgI4M4776RHjx488MADREVF5V+HReSGZ7K6k9f1okmTJnbnzp0Zztu3bx+1atUq4BaJyPVg3759dFpywP0++UY3++POMmfNT3muf/nS0TQ98j3bqtTloV5Tc1VHXm50s/LsSo5dPUZo8VAeDMrZVTVStBljdllrc362dQragxcREXEgBbyIiIgDKeBFREQcSAEvIiLiQAp4ERERB1LAi4iIOJACXkRExIEU8CIiIg6kgBcREXEgBfwNaPHixZQoUeKa5SIjI7n33nsLdL3GGFauXOmxdeZE3bp1mTBhQqGsW0TE0xTwhSQyMhJjTLpX06ZN833dPXr04MCBA9csN2vWLP7xj3/ke3tudK1bt87RMwDyk7WWCRMmUKlSJfz9/WndujV79uy55nJLly6lQYMGBAQEEBISwsMPP5zu8bzvvfcetWvXxtfXl9q1a/PBBx+kq2fOnDlUq1YNPz8/GjduzKZNmzzWN5EbjQK+ELVr1464uLhUr48//jjf1+vv70/58uUznX/16lWstZQqVYrSpUvne3ucKj4+vrCbkGPTpk3jlVdeYfbs2ezYsYPy5cvTvn17zp49m+kyX375JX369KFfv37s2bOHDz/8kL1799K7d293ma1bt9KjRw969+7N7t276d27N927d+err75yl1mxYgVDhw5l7NixfPPNNzRv3pxOnTpx+PDhfO2ziFNdM+CNMWOMMTuMMb8bY04ZY1YZY+qmKWOMMROMMceNMReNMV8YY+qkKeNrjJltjDltjDlvjPm3MaaypztUlPj6+hISEpLqVbZsWfd8Ywxz586la9euBAQEEBERweeff87Ro0fp2LEjgYGBNGjQgK+//tq9TPIw+KpVq4iIiMDPz482bdqk2mNPO1Q+YcIE6taty+LFi7n55pvx9fXl/Pnz6YborbW88sor1KxZE19fXypXrsyYMWPc80ePHs0tt9yCv78/4eHhPPfcc1y6dCnHn8svv/xC9+7dCQwMpHr16ulGEY4dO8ZDDz1EmTJlKFOmDJ07d+ann/73YJGYmBi6du1KSEgIgYGBNGrUiNWrV6eq4+TJk3Tt2hV/f3/CwsJ4880307Vj3rx57s+wXLlydOzYMdPn1sfGxmKMYdmyZbRt2xZ/f3/mzZvHmTNn6NmzJ5UrV8bf3586derw1ltvuZeLjIxkw4YNvP766+5RnNjYWAD27t1L586dCQoKonz58vTs2TPdXrEnWWuZOXMmo0ePplu3btStW5clS5Zw9uxZli5dmulyW7dupXLlygwfPpxq1arRtGlThgwZkiq8Z86cSZs2bRg3bhy1atVi3LhxtG7dmpkzZ7rLzJgxg8jISPr370+tWrWYPXs2FStWZO7cufnWZxEny/oh3C6tgTnADsAAk4C1xpja1tpfkso8BzwLRAI/AC8A0caYW6y1yZv+M4GuQE/gDDADWG2MaWytTfBIb4ANFzZwKuGUp6rLtnJe5WgV0Mrj9U6ePJmoqCiioqJ48cUX6dmzJ/Xr1+fJJ59k9uzZDBs2jMjISL799lv3MpcvX2bixIm89dZbBAQEMHToUO6//352797tfvZ5WgcPHmTp0qX885//xMfHBz8/v3Rlxo4dy9y5c5kxYwYtW7bk1KlTfPPNN+75gYGBvPnmm4SGhrJ3714GDhyIr69vusfaXsukSZOYOnUqU6ZMYdGiRTz66KO0aNGCsLAwLly4QJs2bWjevDkbNmzAx8eHqKgo2rVrx759+wgICODcuXN06tSJyZMn4+/vz4oVK3jggQf49ttvufXWWwFXsB46dIi1a9cSEBDA8OHD3cEKsHPnTgYPHsySJUv44x//yK+//sr69euv2fYxY8YQFRXFokWL8Pb25tKlSzRq1IhRo0ZRsmRJ1q5dy4ABA6hatSp33XUXs2bN4scff+TWW2/lr3/9KwDlypUjLi6Oli1b8thjjxEVFUV8fDzjxo3jvvvuY9u2bRQrlvG2eZ06dTh06FCm7QsLC8t0yP3gwYOcOHGCDh06uKf5+/vTsmVLtmzZwoABAzJc7s4772Ts2LGsWrWKe++9lzNnzrB8+XLuueced5mtW7cyZMiQVMt17NiRv/3tbwBcuXKFXbt2MWLEiFRlOnTowJYtWzLtT1EQPvqjXC/7YM8zVKkK2w6cYcSy3NdzLXl54p1cv64Z8NbajinfG2P6AL8BdwKrjCsxhgFTrbXvJZXpB5wEegHzjDGlgMeAR6y10SnqOQS0Az71VIdOJZzi2NVjnqouX61ZsybdSWeDBw/m5Zdfdr/v27cvPXv2BFwBu2zZMjp27EjXrl0BeO6552jTpg2nT58mODgYcA2xz5o1izvvvBOAt99+m+rVq7Nu3TratWuXYVuuXLnC22+/nemz48+dO8err77KzJkzefTRRwGoUaMGzZo1c5d5/vnn3T+Hh4czduxYoqKichzwffr04eGHHwbgpZdeYtasWWzatImwsDCWL1+OtZa33nrLvbEyb948ypcvz+rVq/nzn/9M/fr1qV+/vru+cePGsWrVKlauXMn48eP58ccf+eSTT9i8ebP7M1qyZAnVq1d3L3P48GECAwO57777CAoKIiwsLFWdmRkyZAgPPpj6sZ4jR450//zEE0+wfv16li1bxl133UWpUqXw8fFxH7tONnfuXOrXr5/q/8Lf//53ypYty86dO7n99tszXP/HH3+c5aEBb2/vTOcljw6k/T9QoUIFjh3L/HeqWbNmLFu2jN69e3Px4kWuXr1K+/btWbJkSaq6M6o3eZ2nT58mISEhwzJr167NdN0ikrns7MGnFYRraP+/Se+rASHAZ8kFrLUXjTEbgebAPKAx4J2mzBFjzL6kMh4L+HJe5TxVVb6vt2XLlsyfPz/VtLTHvOvVq+f+OfmP32233ZZu2smTJ90BX6xYsVQBEBYWRqVKldi7d2+mAV+5cuVMwx1cw8WXL1/mrrvuyrTMypUrmTlzJvv37+fcuXMkJCSQkJDzwZmUfS5evDjlypXj5MmTAOzatYuDBw8SFBSUapkLFy4QExMDwPnz55k4cSKrV68mLi6O+Ph4Ll265K533759mX5Gydq3b09YWBjVqlWjY8eOdOjQgQceeCDdetNq0iT145sTEhKYOnUqK1as4NixY1y+fJkrV67QunXrLOvZtWsXGzduzPCqg5iYmEwDPiwsLMt6syPtKI+1NtORH3D933j66ad5/vnn6dixI3FxcYwcOZIBAwbw97//PUf15nTdIpK53AT8LGA3sDXpffJux89pyv0MhKYokwCczqBMCBkwxjwBPAFQtWrVbDcuP4bJ80tAQAA1atTIskzKPa7kP3QZTUtMTMxTWwIDA7Ocb63Ncv62bdt46KGHePHFF3n11VcpXbo0//73v9MNuWZH2r1MY4y7f4mJiTRo0IDly5enWy75/IURI0awZs0aoqKiqFmzJgEBAfTt25crV65kqy8AQUFBfP3112zcuJHo6GimTJnC2LFj2bFjR6oNgbTSfo5RUVG88sorzJo1i9tuu40SJUowduxY9wZLZhITE+ncuTNRUVHp5mW1IZaXIfrkEYQTJ05QpUoV9/STJ09muc4pU6Zw++23u0cq6tWrR2BgIC1atOAvf/kLVapUISQkJN35AynrDQ4OxsvLK8syIpIzOQp4Y8wM4I/AHzM4bp72r6bJYFq6KjMrY62dD8wHaNKkybX/IotbYmIiO3bsoHnz5oBruPn48ePUqlUr13UmX960bt06atasmW7+l19+SWhoaKph+qyCJrcaNWrEsmXLCA4OzvQM/82bN9O3b1+6desGwKVLl4iJiSEiIgKAWrVqZfoZpVS8eHHatm1L27ZtmThxovswwBNPPJHt9m7evJkuXbrQp08fwLVx8eOPP6Zqu4+PT7qRjkaNGvHuu+8SFhaW5bB6WnkZoq9WrRohISFER0fzhz/8AXB9dps2bWL69OmZLnfhwgW8vLxSTUt+n7wx1axZM6Kjo1MdroiOjnZ//j4+PjRu3Jjo6Gi6d++eqkzy9ygiOZPtgDfGvAo8BLSx1qa8iDp5kzsEOJJienn+t1d/AvACgoFTacpszGGbHePy5cvp9li8vLwoVy5vhxmKFy/OsGHDmDVrFv7+/gwfPpw6depkOjyfHUFBQQwdOpQxY8bg6+tLy5YtOXPmDLt27WLQoEFERERw7Ngx3nnnHZo1a8ann37KsmXL8tSPjPTu3ZuoqCi6du3KpEmTqFq1KkeOHOFf//oXAwcOpGbNmkRERPDBBx/QtWtXvL29mThxYqqz+W+55RbuvvtuBgwYwPz58/H39+eZZ57B39/fXWb16tXExMTQsmVLypYty+eff87Zs2dzvJEUERHBihUr2Lx5M8HBwcyePZuDBw/SsGFDd5nw8HC2b99ObGwsJUqUoGzZsgwePJgFCxbQo0cPRo0aRbly5Thw4ADvvvsur7zySqaHCvIyRG+MYdiwYfzlL3/h1ltvJSIigsmTJ1OiRAl69erlLte3b18A9/B7ly5d6N+/P3PnznUP0Q8bNoxGjRq5R9+GDh1Ky5YtmTJlCvfffz8ffPABn3/+OZs3b3bX+8wzz9CnTx9uv/127rzzTt544w2OHz/OwIEDc90nkRtZtgLeGDMLV7i3ttb+J83sg7gCvD2uM+0xxvgBLYDkzfVdQHxSmaVJZSoDtYCifYpsHqxdu5aKFSummhYaGsrRo0fzVK+vry/jxo2jb9++HD58mKZNm/L+++/n+VjmlClTKFOmDC+99BJHjx6lQoUK7j/2Xbp0YeTIkQwbNoyLFy/SoUMHJk2axJNPPpmndaYVEBDAxo0bGT16NN27d+e3336jUqVKtGnThjJlygCuy60ee+wxWrRoQZkyZRg2bFi6y/UWL15M//79adu2LcHBwbz44ouphs1Lly7Nhx9+yKRJk7hw4QI333wzCxcupEWLFjlq7/jx4zl48CCdOnXC39+fyMhIevfuzd69e91lRowYQb9+/ahduzYXL17k4MGDhIeH8+WXXzJmzBjuvvtuLl26RNWqVenQoQO+vr55+ASz9txzz3Hx4kUGDx7Mf//7X+644w4+++yzVBsUaa9Lj4yM5OzZs/ztb3/j2WefpVSpUrRp04Zp06a5yzRv3pzly5czfvx4XnzxRW6++WZWrFjBHXfc4S7To0cPzpw5w+TJk4mLi6Nu3bp8/PHHHjmvQORGZK51PNIY8zrQB/gTsDfFrHPW2nNJZUYB43BdJvcjMB5oCbgvkzPGzAXuA/rxv8vkygDXvEyuSZMmdufOnRnO27dvX56Gnp1m8eLFPPXUU5w7d66wmyKS7/bt20enJf8bUHzy7prUqBjE/rizzFnzUxZLZs/ypaNpeuR7tlWpy0O9pua5vpx6sOdRqlS9xJHDfqxcln+3DdFlctcfY8wua22Ta5fMXHb24JN3wdalmT4RmJD08zTAH3gdV2h/BXRIcQ08wHDgKrAiqew6oK8nr4EXERERl+xcB3/NcV3rGgaYwP8CP6Myl4AhSS8RERHJR7oXvcNERkZqeF5ERBTwIiIiTqSAFxERcSAFvIiIiAMp4EVERBxIAS8iIuJACngREREHUsBLtoSHh2f4ZDMREbk+KeALSWRkJMYYjDF4e3tTvXp1RowYwfnz5z1Sv6cDeceOHR6/r/yNbM6cOVSrVg0/Pz8aN27Mpk2bsiw/YcIE9/+XtK/ke+jHxcXRq1cvbr31Vry8vIiMjExXT+vWrTOso06dOvnRTREpRAr4QtSuXTvi4uI4cOAAkydPZs6cObl6fnp+Sn6Gerly5QgICMh1PVevXs3Wc9hvBCtWrGDo0KGMHTuWb775hubNm9OpU6d0D3FJacSIEcTFxaV6tWrVitatW1O+fHnA9XTC4OBgRo8eneohLim9//77qeqIjY0lKCiIP//5z/nSVxEpPAr4QuTr60tISAhVqlShV69e9O7dmw8//BBw/bEeNmwYFSpUwM/Pj6ZNm6Z6tGZ8fDxPP/00lSpVwtfXlypVqjB69GjAtZd26NAhRo4c6d5DS7ZlyxZatWpFQEAAoaGhDBo0iN9//909v3Xr1gwaNIgRI0ZQrlw57rzzTiD9iMDhw4e5//77CQoKIigoiAceeCDVU/AmTJhA3bp1Wbx4MTfffDO+vr4Zjk588cUXGGP45JNPaNy4Mf7+/rRo0YKjR4+yYcMG6tevT4kSJbj33ns5c+ZMqmXfeustateujZ+fHxEREbz66qskJia658+YMYN69eoRGBhIaGgojz/+OL/++qt7/uLFiylRogTr1q2jbt26BAYG0qZNGw4ePJiTrzHHZsyYQWRkJP3796dWrVrMnj2bihUrMnfu3EyXKVGiBCEhIe5XfHw8mzZton///u4y4eHhvPbaa0RGRlK2bNkM6ylbtmyqejZv3sz58+d59NFHPd5PESlc2X4efFHxfyd/47dLVwt8vaX8ilO/fKk81eHv7098fDzgemznu+++y5tvvkn16tWZMWMGd999Nz/99BMVK1bktdde44MPPmD58uWEh4dz9OhRfvjhB8C1l1a/fn0effRRBg0a5K7/u+++o0OHDkycOJGFCxfyyy+/MGzYMB599FFWrlzpLvePf/yDJ554gk2bNmW4122t5U9/+hN+fn6sX78eYwxPPfUUf/rTn9ixY4d7g+LgwYMsXbqUf/7zn/j4+ODn55dp31988UVmzpxJqVKl6NWrFz169MDPz4/58+fj5eVF9+7dmTBhArNnzwZgwYIFvPDCC8yePZvGjRvz/fff079/f7y9vXnqqacAKFasGDNnzqR69eocOnSIIUOGMGTIEN5++233ei9fvsyUKVN488038fPzo1+/fgwcOJBPP/0007Z26tTpmkPqmd0u+MqVK+zatSvdSE2HDh3YsiX7T05etGgRpUuXplu3btleJiMLFiygU6dOVKlSJU/1iMj1x3EB/9ulq5y+eKWwm5Fj27dvZ+nSpdx1112cP3+euXPnsnDhQjp3dj3G8Y033mD9+vW8/vrrTJ48mUOHDhEREUGLFi0wxlC1alWaN28OuPbSvLy8CAoKIiQkxL2O6dOn06NHD5599ln3tLlz59KwYUNOnjzpHuqtVq0ar7zySqZtXbt2Lf/3f/9HTEwM4eHhACxdupQaNWqwbt062rVrB7jC7O2336ZChQrX7P9LL73kftb6wIEDGTJkCLt27aJRo0YA9OvXL9VGyEsvvcS0adN48MEH3W0ePXo0c+bMcQf8sGHD3OXDw8OZNm0aXbt2ZcmSJRQr5hq8unr1Kq+//jq3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
)

The graph above is based on pseudo-randomly generated data, so, the results can be
varied by changing the seed. Typically, <!--
  the true $\theta$ will remain within the main non-zero probability part of the
  histogram, but may not necessarily fall in the modal interval of the histogram. More
  generally, for this particular problem, we can expect
--> the mean of inferred distribution will be closer to 0.5 than the true $\theta$. This
is because 0.5 is the mean of our prior for $\theta$.

Bean Machine provides a Diagnostics package that provides helpful statistics about the
result of the inference algorithm. We can query this information as follows:


```python
Markdown(bm.Diagnostics(samples).summary().to_markdown())
```

|           |      avg |      std |     2.5% |     50% |   97.5% |   r_hat |   n_eff |
|:----------|---------:|---------:|---------:|--------:|--------:|--------:|--------:|
| theta()[] | 0.716072 | 0.115433 | 0.466249 | 0.73147 | 0.90287 |   1.003 | 1022.26 |

As is suggested by the visualization, the average and the median are around $0.72$.
Moreover, 95% of the samples fall within the interval $[0.460, 0.904]$. The width of
this interval reflects the reality that we have conditions on few observations, and so
should be quite uncertain about the true $\theta$.


As is suggested by the visualization, the average and the median are around $0.72$.
Moreover, 95% of the samples fall within the interval $[0.460, 0.904]$. The width of
this interval reflects the reality that we have conditions on few observations, and so
should be quite uncertain about the true $\theta$.

The summary output shows two diagnostic statistics:
[$\hat{R}$](https://projecteuclid.org/euclid.ss/1177011136) (`r_hat`) and
[$N_\text{eff}$](https://www.mcmchandbook.net/HandbookChapter1.pdf) (effective sample
size, `n_eff`).

* $\hat{R} \in [1, \infty)$ summarizes how effective inference was at converging on
  the correct posterior distribution for a particular random variable. It uses
  information from all chains run in order to assess whether inference had a good
  understanding of the distribution or not. Values very close to zero indicate that all
  chains discovered similar distributions for a particular random variable. We do not
  recommend using inference results where $\hat{R} > 1.1$, as inference may not have
  converged. In that case, you may want to run inference for more samples.
* $N_\text{eff} \in [1, \texttt{num}\_\texttt{samples}]$ summarizes how independent
  posterior samples are from one another. Although inference was run for `num_samples`
  iterations, it's possible that those samples were very similar to each other (due to
  the way inference is implemented), and may not each be representative of the full
  posterior space. Larger numbers are better here, and if your particular use case calls
  for a certain number of samples to be considered, you should ensure that
  $N_\text{eff}$ is at least that large.

In this case, $\hat{R}$ and $N_\text{eff}$ seem to have acceptable values.


Bean Machine can also plot diagnostical information to assess model fit. Let's take a
look:


Bean Machine can also plot diagnostical information to assess model fit. Let's take a
look:


```python
bm.Diagnostics(samples).plot(display=True);
```

<PlotlyFigure6f95b253b12b4ed68a6c1943a4cee38e />

<PlotlyFigure8ee86c3839b54b939c0fd87c4e81c7ef />

The diagnostics output shows two diagnostic plots for individual random variables: trace
plots and autocorrelation plots.

* Trace plots are simply a time series of values assigned to random variables over each
  iteration of inference. The concrete values assigned are usually problem-specific.
  However, it's important that these values are "mixing" well over time. This means that
  they don't tend to get stuck in one region for large periods of time, and that each of
  the chains ends up exploring the same space as the other chains throughout the course
  of inference.
* Autocorrelation plots measure how predictive the last several samples are of the
  current sample. Autocorrelation may vary between -1.0 (deterministically
  anticorrelated) and 1.0 (deterministically correlated). (We compute autocorrelation
  approximately, so it may sometimes exceed these bounds.) In an ideal world, the
  current sample is chosen independently of the previous samples: an autocorrelation of
  zero. This is not possible in practice, due to stochastic noise and the mechanics of
  how inference works.

From the trace plots, we see each of the chains are healthy: they don't get stuck, and
do not explore a chain-specific subset of the space. From the autocorrelation plots, we
see the absolute magnitude of autocorrelation to be very small, often around 0.1,
indicating a healthy exploration of the space.


## BMGInference


Bean Machine Graph (BMG) Inference is an experimental feature of the Bean Machine
framework that aims to deliver higher performance for specialized models. The model used
in this tutorial represents a static probabilistic graph model and happens to use only
features within the language subset supported by `BMGInference`. Currently, however,
only Newtonian Monte Carlo (NMC) inference is supported by `BMGInference`. So, as a
reference point, the following code reports the time it takes for our basic
implementation of NMC to compute the posterior:


```python
%%time
samples = bm.SingleSiteNewtonianMonteCarlo().infer(
    queries=[theta()],
    observations=observations,
    num_samples=num_samples,
    num_chains=4,
)
```

<CellOutput>
{`CPU times: user 4.42 s, sys: 20.3 ms, total: 4.44 s
Wall time: 4.06 s`}
</CellOutput>

To run our model using `BMGInference`, the only change needed is the following:


```python
%%time
from beanmachine.ppl.inference.bmg_inference import BMGInference

samples_bmg = BMGInference().infer(
    queries=[theta()],
    observations=observations,
    num_samples=num_samples,
    num_chains=4,
)
```

<CellOutput>
{`CPU times: user 475 ms, sys: 0 ns, total: 475 ms
Wall time: 468 ms`}
</CellOutput>

Wall time numbers will naturally vary on different platforms, but with with these
parameters (model, observations, queries, sample size, and number of chains) speedup on
the author's machine is about 40x. Generally speaking, larger speedups are expected with
larger sample sizes. More information about `BMGInference` can be found on the website
in "Advanced" section of the documentation.

